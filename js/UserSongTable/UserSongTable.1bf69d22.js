import{u as e,a,e as s,d as o,q as l,r as n,_ as t,g as i}from"../../assets/index-2ea1dc3c.js";import{s as c}from"../pinia/pinia.07d51cb2.js";import{D as u}from"../DecoratedButton/DecoratedButton.f99c924f.js";import{_ as r}from"../SongList.vue_vue_type_style_index_0_lang/SongList.vue_vue_type_style_index_0_lang.caaeb116.js";import{G as p,i as m,Z as v,o as d,c as g,a as S,U as f,u as h,z as _,n as C,ax as w,d as y,O as N,J as b,F as k,a7 as P,M as V,T as B,I as L,P as j,aq as I,ay as x,az as D}from"../@vue/@vue.7ad02ad1.js";import{P as R}from"../PlayButton/PlayButton.37e50d1e.js";import{S as U}from"../SearchButton/SearchButton.cbd1a9d8.js";import{b as E,c as O,d as G}from"../element-plus/element-plus.372e8740.js";const M={class:"batch-container"},z={class:"operation-select"},A=t(p({__name:"UserBatch",props:{pageName:null},emits:["closeSelect"],setup(t,{emit:i}){const p=t,w=e(),{isPlay:y,songList:N,songListId:b,playProcess:k,playTime:P,current:V}=c(w),B=a(),{songRecord:L,musicDownload:j,loveSongs:I}=c(B),x=_("hideScroll"),D=m((()=>"LoveView"==p.pageName?I.value:"RecentPlayView"==p.pageName?L.value:j.value)),R=m((()=>new Map(D.value.map(((e,a)=>[e.id,a]))))),U=v([]),E=e=>{0!=U.length&&U.splice(0),U.push(...e)},O=async()=>{U.length>0?(y.value=!1,k.value=0,P.value=0,await C(),U.forEach((e=>{null==b.value.get(e.id)&&N.value.unshift(e)})),V.value=b.value.get(U[0].id),y.value=!0,s(o.SUCCESS,"已添加到播放列表！")):s(o.INFO,"请添加歌曲！")},G=()=>{U.forEach((e=>{B.addMuiscDownload(e)}))},A=()=>{if(U.length>0){const e=U.map((e=>e.id)),a=D.value.filter((a=>!e.includes(a.id)));D.value.splice(0),D.value.push(...a),l(n.LOCAL,"songRecord",D.value),s(o.SUCCESS,"已清除选中的歌曲！")}else s(o.INFO,"请添加歌曲！")},F=()=>{x(),i("closeSelect",!1)};return(e,a)=>(d(),g("div",M,[S("div",z,[f(u,{icon:"",name:"播放",class:"play",onClick:O}),f(u,{icon:"",onClick:A,name:"删除"}),f(u,{icon:"󰌄",onClick:G,name:"下载"}),f(u,{icon:"",name:"取消操作",onClick:F})]),f(r,{songs:h(D),"song-id-mapper":h(R),showSelect:!0,"show-header":!1,onGetSelectItems:E},null,8,["songs","song-id-mapper"])]))}}),[["__scopeId","data-v-ee716e2f"]]),F=e=>(x("data-v-4ba0bd28"),e=e(),D(),e),T={class:"sort-btn"},q=[F((()=>S("span",{class:"iconfont"},"",-1))),F((()=>S("span",null," 排序",-1)))],J=t(p({__name:"SortButton",emits:["getSortChoice"],setup(e,{emit:a}){w((e=>({"0714cfa8":h(o),fdda89c0:h(s)})));const s=i().get("searchBg"),o=i().get("fontColor"),l=i().get("background"),n=m((()=>"#ffffff"==l.value?"more-light":"more-dark")),t=v(["歌曲排序","歌手排序","专辑排序","时长排序"]),c=v([!1,!1,!1,!1]),u=y(-1),r=m((()=>c.map(((e,a)=>a==u.value)))),p=e=>{"歌曲排序"==e?u.value=r.value[0]?-1:0:"歌手排序"==e?u.value=r.value[1]?-1:1:"专辑排序"==e?u.value=r.value[2]?-1:2:"时长排序"==e&&(u.value=r.value[3]?-1:3),-1==u.value?a("getSortChoice",r.value,!0):a("getSortChoice",r.value,!1)},_=()=>{-1==u.value&&(u.value=0,a("getSortChoice",r.value,!1))};return(e,a)=>{const s=E,i=O,c=G,u=I("prevent");return d(),g("div",T,[f(c,{trigger:"click",onCommand:p,"popper-class":`more ${h(n)} sort-drop`},{dropdown:N((()=>[f(i,{style:b({background:h(l),color:h(o)})},{default:N((()=>[(d(!0),g(k,null,P(t,((e,a)=>(d(),V(s,{key:e,command:e},{default:N((()=>[S("span",{class:L({"is-choose":h(r)[a]})},B(e),3)])),_:2},1032,["command"])))),128))])),_:1},8,["style"])])),default:N((()=>[j((d(),g("div",{class:"sort",onClick:_},q)),[[u]])])),_:1},8,["popper-class"])])}}}),[["__scopeId","data-v-4ba0bd28"]]),Z={class:"user-container"},$={class:"top-operation"},H=t(p({__name:"UserSongTable",props:{pageName:null},emits:["openSelect"],setup(e,{emit:t}){const i=e,p=a(),{musicDownload:_,loveSongs:C,songRecord:w}=c(p),N=m((()=>{let e=v([]);return e="LoveView"==i.pageName?C.value:"RecentPlayView"==i.pageName?w.value:_.value,e.filter((e=>e.name.includes(B.value)||e.album.includes(B.value)||e.singer.includes(B.value)))})),b=m((()=>new Map(N.value.map(((e,a)=>[e.id,a]))))),k=m((()=>"loveView"==i.pageName?"清空全部收藏":"recentPlayView"==i.pageName?"清空播放记录":"清空下载记录")),P=m((()=>"loveView"==i.pageName?"loveSongs":"recentPlayView"==i.pageName?"songRecord":"musicDownload")),V=m((()=>"RecentPlayView"==i.pageName?"420px":"440px")),B=y(""),L=e=>{B.value=e},j=v([!1,!1,!1,!1]),I=y(!1),x=(e,a)=>{for(let s=0;s<j.length;s++)j[s]=e[s];a&&(I.value=a)},D=()=>{let e=v([]);e="loveView"==i.pageName?C.value:"recentPlayView"==i.pageName?w.value:_.value,e.splice(0),l(n.LOCAL,P.value,e),s(o.SUCCESS,"已清空全部下载记录！")};return(e,a)=>(d(),g("div",Z,[S("div",$,[f(R,{songs:h(N)},null,8,["songs"]),f(u,{icon:"",name:h(k),onClick:D},null,8,["name"]),f(u,{icon:"",name:"批量操作",onClick:a[0]||(a[0]=e=>t("openSelect",!0))}),f(U,{onGetContent:L}),f(J,{onGetSortChoice:x})]),f(r,{songs:h(N),"song-id-mapper":h(b),sort:j,"is-cancel-sort":I.value,height:h(V)},null,8,["songs","song-id-mapper","sort","is-cancel-sort","height"])]))}}),[["__scopeId","data-v-2c5e49bb"]]);export{A as U,H as a};
