import{G as e,ax as a,u as s,i as l,Z as o,o as n,c as t,a as u,U as c,z as i,n as r,r as p,O as v,J as d,F as m,a7 as g,M as f,T as h,I as S,P as C,aq as w,ay as _,az as y,V as k}from"../@vue/@vue.59fec093.js";import{s as b}from"../pinia/pinia.81428a33.js";import{g as N,u as P,a as B,e as V,d as I,_ as j,t as D,P as M}from"../../assets/index-a0247f8c.js";import{D as U}from"../DecoratedButton/DecoratedButton.d6f2fda2.js";import{_ as z,P as L}from"../PlayButton/PlayButton.a1b68cfb.js";import{S as R}from"../SearchButton/SearchButton.f14938d3.js";import{b as E,c as F,d as G}from"../element-plus/element-plus.4a0090f9.js";const x={class:"batch-container"},O={class:"operation-select"},T=j(e({__name:"UserBatch",props:{pageName:null},emits:["closeSelect"],setup(e,{emit:p}){const v=e;a((e=>({"0634ece7":s(d)})));const d=N().get("themeColor"),m=P(),{isPlay:g,songList:f,songListId:h,playProcess:S,playTime:C,current:w}=b(m),_=B(),{songRecord:y,musicDownload:k,loveSongs:j}=b(_),D=i("hideScroll"),M=l((()=>"LoveView"==v.pageName?j.value:"RecentPlayView"==v.pageName?y.value:k.value)),L=l((()=>new Map(M.value.map(((e,a)=>[e.id,a]))))),R=o([]),E=e=>{0!=R.length&&R.splice(0),R.push(...e)},F=async()=>{R.length>0?(g.value=!1,S.value=0,C.value=0,await r(),R.forEach((e=>{null==h.value.get(e.id)&&f.value.unshift(e)})),w.value=h.value.get(R[0].id),g.value=!0,V(I.SUCCESS,"已添加到播放列表！")):V(I.INFO,"请添加歌曲！")},G=()=>{R.forEach((e=>{_.addMuiscDownload(e)}))},T=()=>{if(R.length>0){const e=R.map((e=>e.id)),a=M.value.filter((a=>!e.includes(a.id)));M.value.splice(0),M.value.push(...a),V(I.SUCCESS,"已清除选中的歌曲！")}else V(I.INFO,"请添加歌曲！")},q=()=>{D(),p("closeSelect",!1)};return(e,a)=>(n(),t("div",x,[u("div",O,[c(U,{icon:"",name:"播放",class:"play",onClick:F}),c(U,{icon:"",onClick:T,name:"删除"}),c(U,{icon:"󰌄",onClick:G,name:"下载"}),c(U,{icon:"",name:"取消操作",onClick:q})]),c(z,{songs:s(M),"song-id-mapper":s(L),showSelect:!0,"show-header":!1,onGetSelectItems:E},null,8,["songs","song-id-mapper"])]))}}),[["__scopeId","data-v-855ad860"]]),q=e=>(_("data-v-d459fc75"),e=e(),y(),e),J={class:"sort-btn"},Z=[q((()=>u("span",{class:"iconfont"},"",-1))),q((()=>u("span",null," 排序",-1)))],$=j(e({__name:"SortButton",emits:["getSortChoice"],setup(e,{emit:i}){a((e=>({"667892a2":s(_),"3271bb94":s(b),"383c201f":s(k)})));const r=D(),_=N().get("fontColor"),y=N().get("background"),k=N().get("themeColor"),b=l((()=>{var e;return"color"==r.bgMode?null==(e=N().get("searchBg"))?void 0:e.value:"rgba(210,210,210,0.2)"})),P=l((()=>"color"==r.bgMode?"#ffffff"==_.value?"dropdown-dark":"dropdown-light":"dropdown-skin")),B=o(["歌曲排序","歌手排序","专辑排序","时长排序"]),V=o([!1,!1,!1,!1]),I=p(-1),j=l((()=>V.map(((e,a)=>a==I.value)))),M=e=>{"歌曲排序"==e?I.value=j.value[0]?-1:0:"歌手排序"==e?I.value=j.value[1]?-1:1:"专辑排序"==e?I.value=j.value[2]?-1:2:"时长排序"==e&&(I.value=j.value[3]?-1:3),-1==I.value?i("getSortChoice",j.value,!0):i("getSortChoice",j.value,!1)},U=()=>{-1==I.value&&(I.value=0,i("getSortChoice",j.value,!1))};return(e,a)=>{const l=E,o=F,i=G,r=w("prevent");return n(),t("div",J,[c(i,{trigger:"click",onCommand:M,"popper-class":`dropdown sort-drop ${s(P)}`},{dropdown:v((()=>[c(o,{style:d({color:s(_),background:s(y)})},{default:v((()=>[(n(!0),t(m,null,g(B,((e,a)=>(n(),f(l,{key:e,command:e},{default:v((()=>[u("span",{class:S({"is-choose":s(j)[a]})},h(e),3)])),_:2},1032,["command"])))),128))])),_:1},8,["style"])])),default:v((()=>[C((n(),t("div",{class:"sort",onClick:U},Z)),[[r]])])),_:1},8,["popper-class"])])}}}),[["__scopeId","data-v-d459fc75"]]),A={class:"user-container"},H={class:"top-operation"},K=j(e({__name:"UserSongTable",props:{pageName:null},emits:["openSelect"],setup(e,{emit:a}){const i=e,r=B(),{musicDownload:v,loveSongs:d,songRecord:m}=b(r),g=l((()=>{let e=o([]);return e="LoveView"==i.pageName?d.value:"RecentPlayView"==i.pageName?m.value:v.value,e})),f=l((()=>new Map(g.value.map(((e,a)=>[e.id,a]))))),h=p(1),S=p(40),w=l((()=>g.value.slice((h.value-1)*S.value,h.value*S.value).filter((e=>e.name.includes(P.value)||e.album.includes(P.value)||e.singer.includes(P.value))))),_=l((()=>g.value.length)),y=e=>{h.value=e},N=l((()=>"LoveView"==i.pageName?"清空全部收藏":"RecentPlayView"==i.pageName?"清空播放记录":"清空下载记录")),P=p(""),j=e=>{P.value=e},D=o([!1,!1,!1,!1]),E=p(!1),F=(e,a)=>{for(let s=0;s<D.length;s++)D[s]=e[s];a&&(E.value=a)},G=()=>{"LoveView"==i.pageName?d.value.splice(0):"RecentPlayView"==i.pageName?m.value.splice(0):v.value.splice(0),V(I.SUCCESS,"已清空全部下载记录！")};return(e,l)=>(n(),t("div",A,[u("div",H,[c(L,{songs:s(w)},null,8,["songs"]),c(U,{icon:"",name:s(N),onClick:G},null,8,["name"]),c(U,{icon:"",name:"批量操作",onClick:l[0]||(l[0]=e=>a("openSelect",!0))}),c(R,{onGetContent:j}),c($,{onGetSortChoice:F})]),c(z,{songs:s(w),"song-id-mapper":s(f),sort:D,"page-size":S.value,"is-cancel-sort":E.value},null,8,["songs","song-id-mapper","sort","page-size","is-cancel-sort"]),C(c(M,{"cur-page":h.value,"page-size":S.value,total:s(_),onPageChange:y},null,8,["cur-page","page-size","total"]),[[k,S.value<s(_)]])]))}}),[["__scopeId","data-v-b6c951f5"]]);export{T as U,K as a};
