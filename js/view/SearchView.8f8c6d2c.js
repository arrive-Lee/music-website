import{u as s}from"../element-plus/element-plus.372e8740.js";import{_ as a}from"../SongList.vue_vue_type_style_index_0_lang/SongList.vue_vue_type_style_index_0_lang.ad9427ec.js";import{G as e,d as l,Z as t,c as n,P as o,V as i,U as r,O as u,o as m,a as c,z as p}from"../@vue/@vue.7ad02ad1.js";import{b as g}from"../vue-router/vue-router.53ff932e.js";import{a as d,b as v,n as h,e as f,d as y,o as j,p as _,i as b,j as R,q as L,r as E,_ as S}from"../../assets/index-436cfb30.js";import{s as w}from"../pinia/pinia.07d51cb2.js";import{P as C}from"../PlayButton/PlayButton.fe46fe0f.js";import{D as O}from"../DecoratedButton/DecoratedButton.b48bbfae.js";import{T as x}from"../Tab/Tab.3823af0d.js";import{M as B}from"../Mv/Mv.c8c30b78.js";import{A as P}from"../Albums/Albums.4cfd645f.js";import{P as z}from"../PlayList/PlayList.7dbb9b44.js";import{L as A}from"../Loading/Loading.a215bf41.js";import{S as I}from"../Singer/Singer.05e45537.js";import{N as M}from"../NoSearch/NoSearch.49149f92.js";import{_ as T}from"../OnlineBatch/OnlineBatch.8f93b637.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.8c6d26c7.js";const U={class:"search-container scroll-container"},k={class:"song"},N={class:"top-operation"},D={class:"singers"},G=S(e({__name:"SearchView",setup(e){const S=d(),{loveMusicId:G,loveSongs:V}=w(S),q=l(!1),F=s=>{q.value=s},H=()=>{Z.forEach((s=>{s.isLove=!0;null==G.value.get(s.id)&&V.value.push(s)})),L(E.LOCAL,"loveSongs",V.value)},W=g().query.keyWord+"",Z=t([]),J=t([]),K=t([]),Q=t([]),X=t([]),Y=t([]),$=l(!1),ss=p("firstLoading"),as=p("hideScroll"),es=t([!1,!1,!1,!1,!1]),ls=s=>{as(),"video"==s&&0==J.length?v((async()=>{try{const s=await h(1014,60,W),{result:{videos:a}}=s;a&&a.length>0&&a.forEach((s=>{const{vid:a,title:e,coverUrl:l,creator:t,playTime:n}=s;J.push({id:a,name:e,image:l,artist:t[0].userName,playCount:n})}))}catch(s){f(y.ERROR,s.message)}$.value=!1,es[0]=0==J.length}),$):"mv"==s&&0==K.length?v((async()=>{try{const s=await h(1004,60,W),{result:{mvs:a}}=s;a&&0!=a.length&&a.forEach((s=>{const{id:a,name:e,cover:l,artistName:t,playCount:n}=s;K.push({id:a,name:e,image:l,artist:t,playCount:n})}))}catch(s){f(y.ERROR,s.message)}$.value=!1,es[1]=0==K.length}),$):"album"==s&&0==Q.length?v((async()=>{try{const s=await h(10,60,W),{result:{albums:a}}=s;a&&a.length>0&&a.forEach((s=>{const{id:a,name:e,picUrl:l,publishTime:t,artist:n}=s;Q.push({id:a,name:e,cover:l,publishTime:j(t),artistId:n.id})}))}catch(s){f(y.ERROR,s.message)}$.value=!1,es[2]=0==K.length}),$):"playList"==s&&0==X.length?v((async()=>{try{const s=await h(1e3,60,W),{result:{playlists:a}}=s;a&&a.length>0&&a.forEach((s=>{const{id:a,name:e,coverImgUrl:l,playCount:t}=s;X.push({id:a,name:e,image:l,playCount:t,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(s){f(y.ERROR,s.message)}$.value=!1,es[3]=0==K.length}),$):"singer"==s&&0==Y.length&&v((async()=>{try{const s=await h(100,60,W),{result:{artists:a}}=s;a&&a.length>0&&a.forEach((s=>{const{id:a,name:e,picUrl:l,accountId:t}=s;Y.push({id:a,name:e,avatar:l,score:t})}))}catch(s){f(y.ERROR,s.message)}$.value=!1,es[4]=0==K.length}),$)};return v((async()=>{try{const s=await h(1,100,W),{result:{songs:a}}=s;if(a&&a.length>0){const s=a.map((s=>s.id)).join(","),e=await _(s),{songs:l}=e;l.forEach((s=>{b([],Z,s)})),R(s,Z),S.initLoveMusic(Z)}}catch(s){f(y.ERROR,s.message)}ss.value=!1}),ss),(e,l)=>{const t=a,p=s;return m(),n("div",U,[o(r(T,{songs:Z,onCloseSelect:F},null,8,["songs"]),[[i,q.value]]),o(r(x,{onGetActive:ls,active:"song",class:"search-tab"},{content:u((()=>[r(p,{label:"歌曲",name:"song"},{default:u((()=>[c("div",k,[c("div",N,[r(C,{songs:Z},null,8,["songs"]),r(O,{icon:"",onClick:H,name:"全部收藏"}),r(O,{icon:"",name:"批量操作",onClick:l[0]||(l[0]=s=>q.value=!q.value)})]),r(t,{songs:Z,height:"440px"},null,8,["songs"])])])),_:1}),r(p,{label:"视频",name:"video"},{default:u((()=>[r(A,{"is-loading":$.value},null,8,["is-loading"]),o(r(M,null,null,512),[[i,es[0]]]),o(r(B,{mvs:J},null,8,["mvs"]),[[i,!es[0]]])])),_:1}),r(p,{label:"MV",name:"mv"},{default:u((()=>[r(A,{"is-loading":$.value},null,8,["is-loading"]),o(r(M,null,null,512),[[i,es[1]]]),o(r(B,{mvs:K},null,8,["mvs"]),[[i,!es[1]]])])),_:1}),r(p,{label:"专辑",name:"album"},{default:u((()=>[r(A,{"is-loading":$.value},null,8,["is-loading"]),o(r(M,null,null,512),[[i,es[2]]]),o(r(P,{albums:Q},null,8,["albums"]),[[i,!es[2]]])])),_:1}),r(p,{label:"歌单",name:"playList"},{default:u((()=>[r(A,{"is-loading":$.value},null,8,["is-loading"]),o(r(M,null,null,512),[[i,es[3]]]),o(r(z,{playlists:X},null,8,["playlists"]),[[i,!es[3]]])])),_:1}),r(p,{label:"歌手",name:"singer"},{default:u((()=>[r(A,{"is-loading":$.value},null,8,["is-loading"]),o(r(M,null,null,512),[[i,es[4]]]),o(c("div",D,[r(I,{"singer-list":Y,"show-all-avatar":!1},null,8,["singer-list"])],512),[[i,!es[4]]])])),_:1})])),_:1},512),[[i,!q.value]])])}}}),[["__scopeId","data-v-fd08f2f8"]]);export{G as default};
