import{w as a}from"../element-plus/element-plus.4a0090f9.js";import{t as s,g as e,a as l,u as i,b as n,v as t,e as o,d as r,w as c,x as u,i as m,j as p,y as g,z as v,s as d,A as h,P as y,_ as f}from"../../assets/index-a0247f8c.js";import{G as b,ax as j,i as R,r as C,Z as k,c as w,P as E,V as S,U as z,u as L,a as _,T as x,a2 as O,O as T,z as I,o as P,F as M,a7 as U,S as B,n as A,aq as N}from"../@vue/@vue.59fec093.js";import{b as D,u as F}from"../vue-router/vue-router.2f940de9.js";import{s as q}from"../pinia/pinia.81428a33.js";import{P as G,_ as V}from"../PlayButton/PlayButton.a1b68cfb.js";import{T as H}from"../Tab/Tab.bef77694.js";import{O as J}from"../OnlineBatch/OnlineBatch.aa9d6bfe.js";import{D as K}from"../DecoratedButton/DecoratedButton.d6f2fda2.js";import{M as W}from"../Mv/Mv.8ca69f8a.js";import{A as Z}from"../Albums/Albums.5295aee7.js";import{P as Q}from"../PlayList/PlayList.a4688293.js";import{S as X}from"../Singer/Singer.c577f235.js";import{L as Y}from"../Loading/Loading.184b9483.js";import{_ as $}from"../NoSearch/NoSearch.ca7c48c1.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";const aa={class:"search-container scroll-container"},sa=["src"],ea={class:"right-singer"},la={class:"singer-name"},ia={class:"singer-info"},na={class:"song"},ta={class:"header-operation"},oa={class:"lyric-container"},ra={class:"lyric-operation"},ca=["onClick"],ua=["onClick"],ma=["onClick"],pa=["onClick"],ga=["onClick"],va={class:"lyric-left"},da={class:"song-name"},ha={class:"is-vip iconfont"},ya={class:"lyric-center"},fa={class:"lyric-right"},ba=f(b({__name:"SearchView",setup(f){j((a=>({"8cd416b6":L(ja),"117b9fad":L(ka),"78ef0d61":L(Ca),"028e9fd8":L(Ra),"7c137398":L(wa),"61c5d46a":L(Ea)})));const b=s(),{bgMode:ba}=q(b),ja=I("fontGray"),Ra=e().get("shadow"),Ca=e().get("fontColor"),ka=e().get("themeColor"),wa=R((()=>"skin"==ba.value?"rgba(220, 220, 220, 0.1)":"#ffffff"==(null==Ca?void 0:Ca.value)?"rgba(30, 30, 30, 0.2)":"rgba(220, 220, 220, 0.25)")),Ea=R((()=>"skin"==ba.value?"rgba(230, 230, 230, 0.25)":"#ffffff"==(null==Ca?void 0:Ca.value)?"rgba(30, 30, 30, 1)":"rgba(220, 220, 220, 0.8)")),Sa=F(),za=l(),{loveMusicId:La,loveSongs:_a}=q(za),xa=C(!1),Oa=a=>{xa.value=a},Ta=()=>{Fa.forEach((a=>{a.isLove=!0;null==La.value.get(a.id)&&_a.value.push(a)}))},Ia=i(),{songListId:Pa,songList:Ma,current:Ua,playProcess:Ba,playTime:Aa,isPlay:Na}=q(Ia),Da=D().query.keyWord+"",Fa=k([]),qa=R((()=>new Map(Fa.map(((a,s)=>[a.id,s]))))),Ga=C(1),Va=C(30),Ha=R((()=>Fa.slice((Ga.value-1)*Va.value,Ga.value*Va.value))),Ja=R((()=>Fa.length)),Ka=a=>{Ga.value=a},Wa=k([]),Za=k([]),Qa=k([]),Xa=k([]),Ya=k([]),$a=k([]),as=R((()=>$a.length>0?$a[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),ss=k([]),es=C(!1),ls=I("firstLoading"),is=k([!1,!1,!1,!1,!1,!1,!1]),ns=k([]),ts=a=>{"video"==a&&0==Wa.length?n((async()=>{try{const a=await t(1014,100,Da),{result:{videos:s}}=a;s&&s.length>0&&s.forEach((a=>{const{vid:s,title:e,coverUrl:l,creator:i,playTime:n}=a;Wa.push({id:s,name:e,image:l,artist:i[0].userName,playCount:n})}))}catch(a){o(r.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),is[0]=0==Wa.length}),es):"mv"==a&&0==Za.length?n((async()=>{try{const a=await t(1004,100,Da),{result:{mvs:s}}=a;s&&0!=s.length&&s.forEach((a=>{const{id:s,name:e,cover:l,artistName:i,playCount:n}=a;Za.push({id:s,name:e,image:l,artist:i,playCount:n})}))}catch(a){o(r.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),is[1]=0==Za.length}),es):"album"==a&&0==Qa.length?n((async()=>{try{const a=await t(10,60,Da),{result:{albums:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,publishTime:i,artist:n}=a;Qa.push({id:s,name:e,cover:l,publishTime:c(i),artistId:n.id})}))}catch(a){o(r.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),is[2]=0==Qa.length}),es):"radio"==a&&0==Ya.length?n((async()=>{try{const a=await t(1009,100,Da),{result:{djRadios:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,playCount:i}=a;Ya.push({name:e,id:s,image:l,playCount:i,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){o(r.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),is[3]=0==Ya.length}),es):"playList"==a&&0==Xa.length?n((async()=>{try{const a=await t(1e3,100,Da),{result:{playlists:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,coverImgUrl:l,playCount:i}=a;Xa.push({id:s,name:e,image:l,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){o(r.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),is[4]=0==Xa.length}),es):"lyric"==a&&0==ss.length&&n((async()=>{try{const a=await t(1006,100,Da),{result:{songs:s}}=a;if(s&&s.length>0){const a=s.map((a=>a.id)).join(","),e=await u(a),{songs:l}=e;l.forEach((a=>{ns.push(3),m([],ss,a)})),s.forEach(((a,s)=>{const{lyrics:{txt:e}}=a;ss[s].lyric=e.split("\n")})),p(a,ss),za.initLoveMusic(Fa)}}catch(a){o(r.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),is[6]=0==ss.length}),es)};return n((async()=>{try{const a=await t(1,100,Da),{result:{songs:s}}=a;if(s&&s.length>0){const a=s.map((a=>a.id)).join(","),e=await u(a),{songs:l}=e;l.forEach((a=>{m([],Fa,a)})),p(a,Fa),za.initLoveMusic(Fa)}}catch(a){o(r.ERROR,a.message)}try{const a=await t(100,100,Da),{result:{artists:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,accountId:i,albumSize:n,mvSize:t}=a;$a.push({id:s,name:e,avatar:l,score:i,albumSize:n,mvSize:t})})),is[5]=0==$a.length}catch(a){o(r.ERROR,a.message)}ls.value=!1}),ls),(s,e)=>{const l=y,i=a,n=N("prevent");return P(),w("div",aa,[E(z(J,{songs:L(Ha),"song-id-mapper":L(qa),onCloseSelect:Oa},null,8,["songs","song-id-mapper"]),[[S,xa.value]]),E(_("div",{class:"result-singer",onClick:e[1]||(e[1]=a=>L(Sa).push({name:"artist",query:{id:L(as).id,score:L(as).score}}))},[_("img",{src:L(as).avatar,class:"left-singer"},null,8,sa),_("div",ea,[_("h4",la,"歌手："+x(L(as).name),1),_("p",ia,[_("span",null,"专辑："+x(L(as).albumSize),1),_("span",null,"视频："+x(L(as).mvSize),1)])]),z(K,{name:L(as).isLove?"取消关注":"关注歌手",icon:L(as).isLove?"":"","icon-style":L(as).isLove?"color:#ff6a6a;":"",onClick:e[0]||(e[0]=O((a=>L(za).addLove(L(as),L(za).loveSinger,L(za).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[S,L(as).name]]),E(z(H,{onGetActive:ts,active:"song",class:"search-tab"},{content:T((()=>[z(i,{label:"歌曲",name:"song"},{default:T((()=>[_("div",na,[_("div",ta,[z(G,{songs:L(Ha)},null,8,["songs"]),z(K,{icon:"",onClick:Ta,name:"全部收藏"}),z(K,{icon:"",name:"批量操作",onClick:e[2]||(e[2]=a=>xa.value=!xa.value)})]),z(V,{songs:L(Ha),"page-size":Va.value,"song-id-mapper":L(qa)},null,8,["songs","page-size","song-id-mapper"]),E(z(l,{"cur-page":Ga.value,"page-size":Va.value,total:L(Ja),onPageChange:Ka},null,8,["cur-page","page-size","total"]),[[S,Va.value<L(Ja)]])])])),_:1}),z(i,{label:"视频",name:"video"},{default:T((()=>[z(Y,{"is-loading":es.value},null,8,["is-loading"]),E(z($,{text:"暂无搜索结果"},null,512),[[S,is[0]]]),E(z(W,{mvs:Wa,"show-pagination":!0},null,8,["mvs"]),[[S,!is[0]]])])),_:1}),z(i,{label:"MV",name:"mv"},{default:T((()=>[z(Y,{"is-loading":es.value},null,8,["is-loading"]),E(z($,{text:"暂无搜索结果"},null,512),[[S,is[1]]]),E(z(W,{mvs:Za,"show-pagination":!0},null,8,["mvs"]),[[S,!is[1]]])])),_:1}),z(i,{label:"专辑",name:"album"},{default:T((()=>[z(Y,{"is-loading":es.value},null,8,["is-loading"]),E(z($,{text:"暂无搜索结果"},null,512),[[S,is[2]]]),E(z(Z,{albums:Qa,"show-pagination":!0},null,8,["albums"]),[[S,!is[2]]])])),_:1}),z(i,{label:"电台",name:"radio"},{default:T((()=>[z(Y,{"is-loading":es.value},null,8,["is-loading"]),E(z($,{text:"暂无搜索结果"},null,512),[[S,is[3]]]),E(z(Q,{playlists:Ya,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[S,!is[3]]])])),_:1}),z(i,{label:"歌单",name:"playList"},{default:T((()=>[z(Y,{"is-loading":es.value},null,8,["is-loading"]),E(z($,{text:"暂无搜索结果"},null,512),[[S,is[4]]]),E(z(Q,{playlists:Xa,"show-pagination":!0},null,8,["playlists"]),[[S,!is[4]]])])),_:1}),z(i,{label:"歌手",name:"singer"},{default:T((()=>[z(Y,{"is-loading":es.value},null,8,["is-loading"]),E(z($,{text:"暂无搜索结果"},null,512),[[S,is[5]]]),E(z(X,{"singer-list":$a},null,8,["singer-list"]),[[S,!is[5]]])])),_:1}),z(i,{label:"歌词",name:"lyric"},{default:T((()=>[z(Y,{"is-loading":es.value},null,8,["is-loading"]),E(z($,{text:"暂无搜索结果"},null,512),[[S,is[6]]]),_("div",oa,[(P(!0),w(M,null,U(ss,((a,s)=>{var e;return P(),w("div",{class:"lyric",key:a.id},[_("div",ra,[E((P(),w("span",{class:"iconfont play-music",onClick:s=>(async a=>{if("0"==a.available||"8"==a.available){const s=Pa.value.get(a.id);null==s?(za.addRecord(a,za.songRecord,za.loveMusicId),0==Ua.value?(Na&&(Na.value=!1),Ba.value=0,Aa.value=0,Ma.value.unshift(a),await A(),Na.value=!0):(Ma.value.unshift(a),Ua.value=0)):Ua.value!=s?Ua.value=s:Na.value=!0}else"1"==a.available?o(r.INFO,"此歌曲为vip专属"):"10"==a.available&&o(r.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")})(a)},[B("")],8,ca)),[[n]]),E((P(),w("span",{class:"iconfont music-info",onClick:s=>L(g)(a)},[B("")],8,ua)),[[n]]),E((P(),w("span",{class:"iconfont",onClick:s=>L(v)(a)},[B("")],8,ma)),[[n]]),E((P(),w("span",{class:"open-lyric",onClick:a=>(a=>{ns[a]=ns[a]==ss[a].lyric.length?3:ss[a].lyric.length})(s)},[B(x(ns[s]==(null==(e=a.lyric)?void 0:e.length)?"收起歌词":"展开歌词"),1)],8,pa)),[[n]]),E((P(),w("span",{class:"copy-lyric",onClick:s=>L(d)(a.name+"\r\n"+a.lyric.join("\r\n"),"歌词复制成功！")},[B("复制歌词")],8,ga)),[[n]])]),_("div",va,[_("p",da,[_("span",null,x(a.name),1),E(_("span",ha,"",512),[[S,"10"==a.available||"1"==a.available]])]),(P(!0),w(M,null,U(a.lyric,((a,e)=>E((P(),w("p",{key:e},x(a.trim()),1)),[[S,e<ns[s]]]))),128))]),_("div",ya,[_("span",null,x(a.singer),1)]),_("div",fa,[_("span",null,x(a.album),1),_("span",null,x(L(h)(a.time)),1)])])})),128))])])),_:1})])),_:1},512),[[S,!xa.value]])])}}}),[["__scopeId","data-v-e7ef813d"]]);export{ba as default};
