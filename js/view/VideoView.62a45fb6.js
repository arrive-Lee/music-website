import{w as e}from"../element-plus/element-plus.372e8740.js";import{G as a,ax as t,Z as s,d as l,i,P as o,c as u,U as n,u as r,o as v,ay as c,az as p,a as m,z as d,n as h}from"../@vue/@vue.7ad02ad1.js";import{g as f,b as j,k as g,e as y,d as w,_ as C}from"../../assets/index-74abaf53.js";import{M as b}from"../Mv/Mv.4b3293df.js";import{B as G}from"../ButtonGroup/ButtonGroup.44cdb3d5.js";import{S}from"../SearchButton/SearchButton.33ffa24d.js";import{L as z}from"../Loading/Loading.8f5aaf42.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../vue-router/vue-router.47595bf3.js";import"../nprogress/nprogress.8c6d26c7.js";const B=e=>(c("data-v-56fb3dfd"),e=e(),p(),e),R=["infinite-scroll-disabled"],x=B((()=>m("h4",{class:"title video-choice"},"视频类型",-1))),E=B((()=>m("h4",{class:"title all"},"全部视频",-1))),L=C(a({__name:"VideoView",setup(a){t((e=>({"1327e301":r(c),"2ed7757e":r(m),"5cebd369":r(p)})));const c=f().get("fontColor"),p=f().get("shadow"),m=f().get("fontBlack"),C=s(["全部","韩国","日本","欧美","港台","内地"]),B=s(["全部","官方版","现场版","网易出品"]),L=s(["上升最快","最新","最热"]),M=l(0),V=l(0),_=l(0),k=s(new Map),A=s(new Map);let N=s([]),O=s([]);const T=l(50),U=l(30),I=l(!1),J=l(!1),K=d("firstLoading"),P=d("hideScroll"),Z=i((()=>N.filter((e=>e.name.includes(q.value)||e.artist.includes(q.value))))),q=l(""),D=e=>{q.value=e},F=async(e,a)=>{A.set(M.value+""+V.value+_.value,T.value),P(),N.splice(0),O.splice(0),"视频地区"==a?M.value=e:"视频来源"==a?V.value=e:_.value=e,U.value=40;const t=A.get(M.value+""+V.value+_.value);T.value=t||50,await h();const s=k.get(M.value+""+V.value+_.value);s?(N.push(...s),O.push(...s.slice(0,U.value))):W()},H=()=>{q.value||(J.value=!0,I.value=!0,U.value+=10,U.value<N.length?setTimeout((()=>{O.push(...N.slice(O.length,U.value)),J.value=!1,I.value=!1}),100):T.value==N.length?(T.value*=2,Q()):(O.push(...N.slice(O.length)),J.value=!1,y(w.SUCCESS,"已经到达底部！")))},Q=()=>{j((async()=>{try{const e=await g(T.value,C[M.value],B[V.value],L[_.value]),{data:a}=e;a.slice(N.length).forEach((e=>{const{id:a,name:t,cover:s,playCount:l,artistName:i}=e;N.push({id:a,name:t,image:s,playCount:l,artist:i})})),k.set(M.value+""+V.value+_.value,[...N]),O.push(...N.slice(O.length,U.value))}catch(e){y(w.ERROR,e.message)}J.value=!1,I.value=!1}),J)},W=()=>{j((async()=>{try{const e=await g(T.value,C[M.value],B[V.value],L[_.value]),{data:a}=e;a.forEach((e=>{const{id:a,name:t,cover:s,playCount:l,artistName:i}=e;N.push({id:a,name:t,image:s,playCount:l,artist:i})})),k.set(M.value+""+V.value+_.value,[...N]),O.push(...N.slice(0,U.value))}catch(e){y(w.ERROR,e.message)}setTimeout((()=>{K.value=!1}),200)}),K)};return W(),(a,t)=>{const s=e;return o((v(),u("div",{class:"rvideo-container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":I.value,style:{overflow:"auto"}},[n(S,{onGetContent:D}),x,n(G,{onGetActive:F,title:"视频地区",activeValue:0,"show-title":!1,type:C,class:"area"},null,8,["type"]),n(G,{onGetActive:F,title:"视频来源",activeValue:0,"show-title":!1,type:B},null,8,["type"]),n(G,{onGetActive:F,title:"视频排序","show-title":!1,activeValue:0,type:L},null,8,["type"]),E,n(b,{mvs:r(Z)},null,8,["mvs"]),n(z,{"is-loading":J.value},null,8,["is-loading"])],8,R)),[[s,H]])}}}),[["__scopeId","data-v-56fb3dfd"]]);export{L as default};
