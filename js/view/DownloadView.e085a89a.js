import{u as e}from"../element-plus/element-plus.372e8740.js";import{G as s,ax as a,i as o,d as t,Z as l,c as n,U as i,O as u,u as r,o as m,P as c,V as p,a as v,z as d,n as j}from"../@vue/@vue.7ad02ad1.js";import{g as f,a as g,u as h,c as S,l as _,f as C,h as y,e as w,s as D,_ as L}from"../../assets/index-dfd2942e.js";import{T as x}from"../Tab/Tab.11fd8cd7.js";import{P as B}from"../PlayButton/PlayButton.0af80b93.js";import{D as b}from"../DecoratedButton/DecoratedButton.3b1b6d67.js";import{_ as k}from"../SongList.vue_vue_type_style_index_0_lang/SongList.vue_vue_type_style_index_0_lang.0c66c5ca.js";import{S as z}from"../SearchButton/SearchButton.3b8e2cf2.js";import{M as G}from"../Mv/Mv.e68b57e3.js";import{s as I}from"../pinia/pinia.07d51cb2.js";import{S as O}from"../SortButton/SortButton.6d89d3d5.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../axios/axios.d4208f68.js";import"../vue-router/vue-router.53ff932e.js";import"../nprogress/nprogress.8c6d26c7.js";const P={class:"download-container scroll-container"},A={class:"top-operation"},E={class:"top-operation operation-select"},M=L(s({__name:"DownloadView",setup(s){a((e=>({"0276499d":r(L)})));const L=f().get("fontColor"),M=g(),{mvDownload:T,musicDownload:U}=I(M),N=h(),{isPlay:F,songList:V,songListId:H,playProcess:J,playTime:Z,current:q}=I(N),K=o((()=>U.value.filter((e=>e.name.includes(Q.value)||e.album.includes(Q.value)||e.singer.includes(Q.value))))),Q=t(""),R=d("firstLoading"),W=d("hideScroll"),X=()=>{W()},Y=e=>{Q.value=e},$=l([!1,!1,!1,!1]),ee=t(!1),se=(e,s)=>{for(let a=0;a<$.length;a++)$[a]=e[a];s&&(ee.value=s)},ae=t(!1);let oe=l([]);const te=e=>{oe=l([]),oe.push(...e)},le=async()=>{oe.length>0?(F.value=!1,J.value=0,Z.value=0,await j(),oe.forEach((e=>{null==H.value.get(e.id)&&V.value.unshift(e)})),q.value=H.value.get(oe[0].id),F.value=!0,C(y.SUCCESS,"已添加到播放列表！")):C(y.INFO,"请添加歌曲！")},ne=()=>{oe.forEach((e=>{M.addMuiscDownload(e)}))},ie=()=>{if(oe.length>0){const e=oe.map((e=>e.id)),s=U.value.filter((s=>!e.includes(s.id)));U.value.splice(0),U.value.push(...s),w(D.LOCAL,"musicDownload",U.value),C(y.SUCCESS,"已清除选中的歌曲！")}else C(y.INFO,"请添加歌曲！")},ue=()=>{U.value.splice(0),w(D.LOCAL,"musicDownload",U.value),C(y.SUCCESS,"已清空全部下载记录！")},re=e=>{T.value.splice(e,1),w(D.LOCAL,"mvDownload",T)};return S((async()=>{const e=U.value.map((e=>e.id)).join(",");_(e,U.value),M.initLoveMusic(U.value),R.value=!1}),R),(s,a)=>{const o=e;return m(),n("div",P,[i(x,{active:"song",onGetActive:X},{content:u((()=>[i(o,{label:"下载歌曲",name:"song"},{default:u((()=>[c(v("div",A,[i(B,{songs:r(U)},null,8,["songs"]),i(b,{icon:"",name:"清空下载记录",onClick:ue}),i(b,{icon:"",name:"批量操作",onClick:a[0]||(a[0]=e=>ae.value=!ae.value)}),i(z,{onGetContent:Y}),i(O,{onGetSortChoice:se})],512),[[p,!ae.value]]),c(v("div",E,[i(b,{icon:"",name:"播放",class:"play",onClick:le}),i(b,{icon:"",onClick:ie,name:"删除"}),i(b,{icon:"󰌄",onClick:ne,name:"下载"}),i(b,{icon:"",name:"取消操作",onClick:a[1]||(a[1]=e=>ae.value=!ae.value)})],512),[[p,ae.value]]),i(k,{songs:r(K),showSelect:ae.value,sort:$,"is-cancel-sort":ee.value,onGetSelectItems:te,height:"440px"},null,8,["songs","showSelect","sort","is-cancel-sort"])])),_:1}),i(o,{label:"下载视频",name:"video "},{default:u((()=>[i(G,{mvs:r(T),"show-delete":!0,transitionName:"list",onGetDeleteIndex:re},null,8,["mvs"])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-df0d97fb"]]);export{M as default};
