import{u as a}from"../element-plus/element-plus.5cae0800.js";import{_ as s,P as e}from"../NoSearch/NoSearch.36c5e9e0.js";import{G as l,ax as i,i as n,r as t,Z as o,c as r,P as c,V as u,U as m,u as p,a as g,T as v,a2 as d,O as h,z as y,o as f,F as b,a7 as j,S as R,n as C,aq as k}from"../@vue/@vue.59fec093.js";import{b as S,u as E}from"../vue-router/vue-router.2f940de9.js";import{s as w}from"../pinia/pinia.81428a33.js";import{t as L,g as z,a as _,u as x,b as O,v as T,e as I,d as P,w as M,x as U,i as B,j as A,y as N,z as D,s as F,A as G,_ as q}from"../../assets/index-c885de52.js";import{P as V,_ as J}from"../PlayButton/PlayButton.80a62826.js";import{T as K}from"../Tab/Tab.5e4df894.js";import{O as W}from"../OnlineBatch/OnlineBatch.043664a2.js";import{D as Z}from"../DecoratedButton/DecoratedButton.86ecbdbc.js";import{M as H}from"../Mv/Mv.95596618.js";import{A as Q}from"../Albums/Albums.27e91b6c.js";import{P as X}from"../PlayList/PlayList.dde64e29.js";import{S as Y}from"../Singer/Singer.430425e6.js";import{L as $}from"../Loading/Loading.483dcedc.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";const aa={class:"search-container scroll-container"},sa=["src"],ea={class:"right-singer"},la={class:"singer-name"},ia={class:"singer-info"},na={class:"song"},ta={class:"header-operation"},oa={class:"lyric-container"},ra={class:"lyric-operation"},ca=["onClick"],ua=["onClick"],ma=["onClick"],pa=["onClick"],ga=["onClick"],va={class:"lyric-left"},da={class:"song-name"},ha={class:"is-vip iconfont"},ya={class:"lyric-center"},fa={class:"lyric-right"},ba=q(l({__name:"SearchView",setup(l){i((a=>({37033040:p(ja),24143028:p(ka),a9d5fcf4:p(Ca),"34b493fd":p(Ra),"26428d22":p(Sa),e6a370b6:p(Ea)})));const q=L(),{bgMode:ba}=w(q),ja=y("fontGray"),Ra=z().get("shadow"),Ca=z().get("fontColor"),ka=z().get("themeColor"),Sa=n((()=>"skin"==ba.value?"rgba(220, 220, 220, 0.1)":"#ffffff"==(null==Ca?void 0:Ca.value)?"rgba(30, 30, 30, 0.2)":"rgba(220, 220, 220, 0.25)")),Ea=n((()=>"skin"==ba.value?"rgba(230, 230, 230, 0.25)":"#ffffff"==(null==Ca?void 0:Ca.value)?"rgba(30, 30, 30, 1)":"rgba(220, 220, 220, 0.8)")),wa=E(),La=_(),{loveMusicId:za,loveSongs:_a}=w(La),xa=t(!1),Oa=a=>{is(),xa.value=a},Ta=()=>{qa.forEach((a=>{a.isLove=!0;null==za.value.get(a.id)&&_a.value.push(a)}))},Ia=x(),{songListId:Pa,songList:Ma,current:Ua,playProcess:Ba,playTime:Aa,isPlay:Na}=w(Ia),Da=S().query.keyWord+"",Fa=t(1),Ga=t(50),qa=o([]),Va=n((()=>qa.slice(Fa.value-1,Fa.value*Ga.value))),Ja=n((()=>qa.length)),Ka=a=>{Fa.value=a},Wa=n((()=>new Map(qa.map(((a,s)=>[a.id,s]))))),Za=o([]),Ha=o([]),Qa=o([]),Xa=o([]),Ya=o([]),$a=o([]),as=n((()=>$a.length>0?$a[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),ss=o([]),es=t(!1),ls=y("firstLoading"),is=y("hideScroll"),ns=o([!1,!1,!1,!1,!1,!1,!1]),ts=o([]),os=a=>{is(),"video"==a&&0==Za.length?O((async()=>{try{const a=await T(1014,60,Da),{result:{videos:s}}=a;s&&s.length>0&&s.forEach((a=>{const{vid:s,title:e,coverUrl:l,creator:i,playTime:n}=a;Za.push({id:s,name:e,image:l,artist:i[0].userName,playCount:n})}))}catch(a){I(P.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),ns[0]=0==Za.length}),es):"mv"==a&&0==Ha.length?O((async()=>{try{const a=await T(1004,60,Da),{result:{mvs:s}}=a;s&&0!=s.length&&s.forEach((a=>{const{id:s,name:e,cover:l,artistName:i,playCount:n}=a;Ha.push({id:s,name:e,image:l,artist:i,playCount:n})}))}catch(a){I(P.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),ns[1]=0==Ha.length}),es):"album"==a&&0==Qa.length?O((async()=>{try{const a=await T(10,60,Da),{result:{albums:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,publishTime:i,artist:n}=a;Qa.push({id:s,name:e,cover:l,publishTime:M(i),artistId:n.id})}))}catch(a){I(P.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),ns[2]=0==Qa.length}),es):"radio"==a&&0==Ya.length?O((async()=>{try{const a=await T(1009,60,Da),{result:{djRadios:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,playCount:i}=a;Ya.push({name:e,id:s,image:l,playCount:i,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){I(P.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),ns[3]=0==Ya.length}),es):"playList"==a&&0==Xa.length?O((async()=>{try{const a=await T(1e3,60,Da),{result:{playlists:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,coverImgUrl:l,playCount:i}=a;Xa.push({id:s,name:e,image:l,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){I(P.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),ns[4]=0==Xa.length}),es):"lyric"==a&&0==ss.length&&O((async()=>{try{const a=await T(1006,60,Da),{result:{songs:s}}=a;if(s&&s.length>0){const a=s.map((a=>a.id)).join(","),e=await U(a),{songs:l}=e;l.forEach((a=>{ts.push(3),B([],ss,a)})),s.forEach(((a,s)=>{const{lyrics:{txt:e}}=a;ss[s].lyric=e.split("\n")})),A(a,ss),La.initLoveMusic(qa)}}catch(a){I(P.ERROR,a.message)}setTimeout((()=>{es.value=!1}),500),ns[6]=0==ss.length}),es)};return O((async()=>{try{const a=await T(1,100,Da),{result:{songs:s}}=a;if(s&&s.length>0){const a=s.map((a=>a.id)).join(","),e=await U(a),{songs:l}=e;l.forEach((a=>{B([],qa,a)})),A(a,qa),La.initLoveMusic(qa)}}catch(a){I(P.ERROR,a.message)}try{const a=await T(100,60,Da),{result:{artists:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,accountId:i,albumSize:n,mvSize:t}=a;$a.push({id:s,name:e,avatar:l,score:i,albumSize:n,mvSize:t})})),ns[5]=0==$a.length}catch(a){I(P.ERROR,a.message)}ls.value=!1}),ls),(l,i)=>{const n=e,t=a,o=k("prevent");return f(),r("div",aa,[c(m(W,{songs:p(Va),"song-id-mapper":p(Wa),onCloseSelect:Oa},null,8,["songs","song-id-mapper"]),[[u,xa.value]]),c(g("div",{class:"result-singer",onClick:i[1]||(i[1]=a=>p(wa).push({name:"artist",query:{id:p(as).id,score:p(as).score}}))},[g("img",{src:p(as).avatar,class:"left-singer"},null,8,sa),g("div",ea,[g("h4",la,"歌手："+v(p(as).name),1),g("p",ia,[g("span",null,"专辑："+v(p(as).albumSize),1),g("span",null,"视频："+v(p(as).mvSize),1)])]),m(Z,{name:p(as).isLove?"取消关注":"关注歌手",icon:p(as).isLove?"":"","icon-style":p(as).isLove?"color:#ff6a6a;":"",onClick:i[0]||(i[0]=d((a=>p(La).addLove(p(as),p(La).loveSinger,p(La).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[u,p(as).name]]),c(m(K,{onGetActive:os,active:"song",class:"search-tab"},{content:h((()=>[m(t,{label:"歌曲",name:"song"},{default:h((()=>[g("div",na,[g("div",ta,[m(V,{songs:p(Va)},null,8,["songs"]),m(Z,{icon:"",onClick:Ta,name:"全部收藏"}),m(Z,{icon:"",name:"批量操作",onClick:i[2]||(i[2]=a=>xa.value=!xa.value)})]),m(J,{songs:p(Va),"song-id-mapper":p(Wa)},null,8,["songs","song-id-mapper"]),c(m(n,{"cur-page":Fa.value,"page-size":Ga.value,total:p(Ja),onPageChange:Ka},null,8,["cur-page","page-size","total"]),[[u,Ga.value<p(Ja)]])])])),_:1}),m(t,{label:"视频",name:"video"},{default:h((()=>[m($,{"is-loading":es.value},null,8,["is-loading"]),c(m(s,{text:"暂无搜索结果"},null,512),[[u,ns[0]]]),c(m(H,{mvs:Za},null,8,["mvs"]),[[u,!ns[0]]])])),_:1}),m(t,{label:"MV",name:"mv"},{default:h((()=>[m($,{"is-loading":es.value},null,8,["is-loading"]),c(m(s,{text:"暂无搜索结果"},null,512),[[u,ns[1]]]),c(m(H,{mvs:Ha},null,8,["mvs"]),[[u,!ns[1]]])])),_:1}),m(t,{label:"专辑",name:"album"},{default:h((()=>[m($,{"is-loading":es.value},null,8,["is-loading"]),c(m(s,{text:"暂无搜索结果"},null,512),[[u,ns[2]]]),c(m(Q,{albums:Qa},null,8,["albums"]),[[u,!ns[2]]])])),_:1}),m(t,{label:"电台",name:"radio"},{default:h((()=>[m($,{"is-loading":es.value},null,8,["is-loading"]),c(m(s,{text:"暂无搜索结果"},null,512),[[u,ns[3]]]),c(m(X,{playlists:Ya,type:"radio"},null,8,["playlists"]),[[u,!ns[3]]])])),_:1}),m(t,{label:"歌单",name:"playList"},{default:h((()=>[m($,{"is-loading":es.value},null,8,["is-loading"]),c(m(s,{text:"暂无搜索结果"},null,512),[[u,ns[4]]]),c(m(X,{playlists:Xa},null,8,["playlists"]),[[u,!ns[4]]])])),_:1}),m(t,{label:"歌手",name:"singer"},{default:h((()=>[m($,{"is-loading":es.value},null,8,["is-loading"]),c(m(s,{text:"暂无搜索结果"},null,512),[[u,ns[5]]]),c(m(Y,{"singer-list":$a},null,8,["singer-list"]),[[u,!ns[5]]])])),_:1}),m(t,{label:"歌词",name:"lyric"},{default:h((()=>[m($,{"is-loading":es.value},null,8,["is-loading"]),c(m(s,{text:"暂无搜索结果"},null,512),[[u,ns[6]]]),g("div",oa,[(f(!0),r(b,null,j(ss,((a,s)=>{var e;return f(),r("div",{class:"lyric",key:a.id},[g("div",ra,[c((f(),r("span",{class:"iconfont play-music",onClick:s=>(async a=>{if("0"==a.available||"8"==a.available){const s=Pa.value.get(a.id);null==s?(La.addRecord(a,La.songRecord,La.loveMusicId),0==Ua.value?(Na&&(Na.value=!1),Ba.value=0,Aa.value=0,Ma.value.unshift(a),await C(),Na.value=!0):(Ma.value.unshift(a),Ua.value=0)):Ua.value!=s?Ua.value=s:Na.value=!0}else"1"==a.available?I(P.INFO,"此歌曲为vip专属"):"10"==a.available&&I(P.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")})(a)},[R("")],8,ca)),[[o]]),c((f(),r("span",{class:"iconfont music-info",onClick:s=>p(N)(a)},[R("")],8,ua)),[[o]]),c((f(),r("span",{class:"iconfont",onClick:s=>p(D)(a)},[R("")],8,ma)),[[o]]),c((f(),r("span",{class:"open-lyric",onClick:a=>(a=>{ts[a]=ts[a]==ss[a].lyric.length?3:ss[a].lyric.length})(s)},[R(v(ts[s]==(null==(e=a.lyric)?void 0:e.length)?"收起歌词":"展开歌词"),1)],8,pa)),[[o]]),c((f(),r("span",{class:"copy-lyric",onClick:s=>p(F)(a.name+"\r\n"+a.lyric.join("\r\n"),"歌词复制成功！")},[R("复制歌词")],8,ga)),[[o]])]),g("div",va,[g("p",da,[g("span",null,v(a.name),1),c(g("span",ha,"",512),[[u,"10"==a.available||"1"==a.available]])]),(f(!0),r(b,null,j(a.lyric,((a,e)=>c((f(),r("p",{key:e},v(a.trim()),1)),[[u,e<ts[s]]]))),128))]),g("div",ya,[g("span",null,v(a.singer),1)]),g("div",fa,[g("span",null,v(a.album),1),g("span",null,v(p(G)(a.time)),1)])])})),128))])])),_:1})])),_:1},512),[[u,!xa.value]])])}}}),[["__scopeId","data-v-a3c73f10"]]);export{ba as default};
