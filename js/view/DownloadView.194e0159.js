import{u as e}from"../element-plus/element-plus.372e8740.js";import{G as s,ax as a,d as o,Z as l,c as t,U as n,O as i,u,o as r,P as m,V as c,a as p,z as v,n as d}from"../@vue/@vue.7ad02ad1.js";import{g as j,a as f,u as h,c as g,l as C,f as S,h as y,e as w,s as D,_ as L}from"../../assets/index-964692d5.js";import{T as _,_ as k}from"../Tab/Tab.500b9b1b.js";import{P as z}from"../PlayButton/PlayButton.a2a16fce.js";import{D as B}from"../DecoratedButton/DecoratedButton.162503fc.js";import{S as b}from"../SearchButton/SearchButton.b31e88b7.js";import{M as x}from"../Mv/Mv.4e0814f8.js";import{s as I}from"../pinia/pinia.07d51cb2.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../axios/axios.d4208f68.js";import"../vue-router/vue-router.53ff932e.js";import"../nprogress/nprogress.8c6d26c7.js";import"../lodash/lodash.57b1d944.js";import"../default-passive-events/default-passive-events.8ad95ed0.js";const P={class:"download-container scroll-container"},E={class:"top-operation"},M={class:"top-operation operation-select"},O=L(s({__name:"DownloadView",setup(s){a((e=>({"47e8da24":u(L)})));const L=j().get("fontColor"),O=f(),{mvDownload:A,musicDownload:G}=I(O),T=h(),{isPlay:U,songList:F,songListId:N,playProcess:V,playTime:Z,current:q}=I(T);let H;const J=o(""),K=v("firstLoading"),Q=v("hideScroll"),R=()=>{Q()},W=e=>{H=l([]),J.value=e;const s=G.value.filter((e=>e.name.includes(J.value)||e.album.includes(J.value)||e.singer.includes(J.value)));H.push(...s)},X=o(!1);let Y=l([]);const $=e=>{Y=l([]),Y.push(...e)},ee=async()=>{Y.length>0?(U.value=!1,V.value=0,Z.value=0,await d(),Y.forEach((e=>{null==N.value.get(e.id)&&F.value.unshift(e)})),q.value=N.value.get(Y[0].id),U.value=!0,S(y.SUCCESS,"已添加到播放列表！")):S(y.INFO,"请添加歌曲！")},se=()=>{Y.forEach((e=>{O.addMuiscDownload(e)}))},ae=()=>{if(Y.length>0){const e=Y.map((e=>e.id)),s=G.value.filter((s=>!e.includes(s.id)));G.value.splice(0),G.value.push(...s),w(D.LOCAL,"musicDownload",G.value),S(y.SUCCESS,"已清除选中的歌曲！")}else S(y.INFO,"请添加歌曲！")},oe=()=>{G.value.splice(0),w(D.LOCAL,"musicDownload",G.value),S(y.SUCCESS,"已清空全部下载记录！")};return g((async()=>{const e=G.value.map((e=>e.id)).join(",");C(e,G.value),O.initLoveMusic(G.value),K.value=!1}),K),(s,a)=>{const o=e;return r(),t("div",P,[n(_,{active:"song",onGetActive:R},{content:i((()=>[n(o,{label:"下载歌曲",name:"song"},{default:i((()=>[m(p("div",E,[n(z,{songs:u(G)},null,8,["songs"]),n(B,{icon:"",name:"清空下载记录",onClick:oe}),n(B,{icon:"",name:"批量操作",onClick:a[0]||(a[0]=e=>X.value=!X.value)}),n(b,{onGetContent:W})],512),[[c,!X.value]]),m(p("div",M,[n(B,{icon:"",name:"播放",class:"play",onClick:ee}),n(B,{icon:"",onClick:ae,name:"删除"}),n(B,{icon:"󰌄",onClick:se,name:"下载"}),n(B,{icon:"",name:"取消操作",onClick:a[1]||(a[1]=e=>X.value=!X.value)})],512),[[c,X.value]]),n(k,{songs:J.value?u(H):u(G),showSelect:X.value,onGetSelectItems:$,height:"440px"},null,8,["songs","showSelect"])])),_:1}),n(o,{label:"下载视频",name:"video "},{default:i((()=>[n(x,{mvs:u(A),lazyLoad:u(A).length>12},null,8,["mvs","lazyLoad"])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-20e2e5f4"]]);export{O as default};
