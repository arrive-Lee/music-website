import{w as e}from"../element-plus/element-plus.372e8740.js";import{S as a}from"../SearchButton/SearchButton.b423fc9b.js";import{G as t,ax as s,Z as l,d as i,i as o,P as u,c as n,U as r,u as v,o as c,ay as p,az as m,a as d,z as h,n as j}from"../@vue/@vue.7ad02ad1.js";import{g,c as f,m as y,f as w,h as C,_ as G}from"../../assets/index-a986877f.js";import{M as S}from"../Mv/Mv.ee59ba99.js";import{B as z}from"../ButtonGroup/ButtonGroup.c02162f5.js";import{L as B}from"../Loading/Loading.070a0162.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../axios/axios.d4208f68.js";import"../pinia/pinia.07d51cb2.js";import"../vue-router/vue-router.53ff932e.js";import"../nprogress/nprogress.8c6d26c7.js";const R=e=>(p("data-v-bd0ac84a"),e=e(),m(),e),b=["infinite-scroll-disabled"],x=R((()=>d("h4",{class:"title video-choice"},"视频类型",-1))),E=R((()=>d("h4",{class:"title all"},"全部视频",-1))),M=G(t({__name:"VideoView",setup(t){s((e=>({c4c0d390:v(p),"68122ca7":v(d),"9d4dd9c0":v(m)})));const p=g().get("fontColor"),m=g().get("shadow"),d=g().get("fontBlack"),G=l(["全部","韩国","日本","欧美","港台","内地"]),R=l(["全部","官方版","现场版","网易出品"]),M=l(["上升最快","最新","最热"]),V=i(0),_=i(0),L=i(0),A=l(new Map),k=l(new Map);let I=l([]),N=l([]);const O=i(50),T=i(30),U=i(!1),F=i(!1),H=h("firstLoading"),P=h("hideScroll"),Z=o((()=>I.filter((e=>e.name.includes(q.value)||e.artist.includes(q.value))))),q=i(""),D=e=>{q.value=e},J=async(e,a)=>{k.set(V.value+""+_.value+L.value,O.value),P(),I.splice(0),N.splice(0),"视频地区"==a?V.value=e:"视频来源"==a?_.value=e:L.value=e,T.value=40;const t=k.get(V.value+""+_.value+L.value);O.value=t||50,await j();const s=A.get(V.value+""+_.value+L.value);s?(I.push(...s),N.push(...s.slice(0,T.value))):W()},K=()=>{q.value||(F.value=!0,U.value=!0,setTimeout((()=>{T.value+=10,T.value<=I.length?(N.push(...I.slice(N.length,T.value)),F.value=!1,U.value=!1):O.value==I.length?(O.value*=2,Q()):(N.push(...I.slice(N.length)),F.value=!1,w(C.SUCCESS,"已经到达底部！"))}),1e3))},Q=()=>{f((async()=>{try{const e=await y(O.value,G[V.value],R[_.value],M[L.value]),{data:a}=e;a.slice(I.length).forEach((e=>{const{id:a,name:t,cover:s,playCount:l,artistName:i}=e;I.push({id:a,name:t,image:s,playCount:l,artist:i})})),A.set(V.value+""+_.value+L.value,[...I]),N.push(...I.slice(N.length,T.value))}catch(e){w(C.ERROR,e.message)}F.value=!1,U.value=!1}),F)},W=()=>{f((async()=>{try{const e=await y(O.value,G[V.value],R[_.value],M[L.value]),{data:a}=e;a.forEach((e=>{const{id:a,name:t,cover:s,playCount:l,artistName:i}=e;I.push({id:a,name:t,image:s,playCount:l,artist:i})})),A.set(V.value+""+_.value+L.value,[...I]),N.push(...I.slice(0,T.value))}catch(e){w(C.ERROR,e.message)}setTimeout((()=>{H.value=!1}),200)}),H)};return W(),(t,s)=>{const l=a,i=e;return u((c(),n("div",{class:"rvideo-container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":U.value,style:{overflow:"auto"}},[r(l,{onGetContent:D}),x,r(z,{onGetActive:J,title:"视频地区",activeValue:0,"show-title":!1,type:G,class:"area"},null,8,["type"]),r(z,{onGetActive:J,title:"视频来源",activeValue:0,"show-title":!1,type:R},null,8,["type"]),r(z,{onGetActive:J,title:"视频排序","show-title":!1,activeValue:0,type:M},null,8,["type"]),E,r(S,{mvs:v(Z)},null,8,["mvs"]),r(B,{"is-loading":F.value},null,8,["is-loading"])],8,b)),[[i,K]])}}}),[["__scopeId","data-v-bd0ac84a"]]);export{M as default};
