import{u as a}from"../element-plus/element-plus.1ffadbb7.js";import{G as s,ax as e,i as l,r as i,Z as n,c as t,P as o,V as r,U as c,u,a as m,T as p,a2 as g,O as v,z as d,o as h,F as y,a7 as f,S as b,n as j,aq as R}from"../@vue/@vue.59fec093.js";import{b as C,u as k}from"../vue-router/vue-router.2f940de9.js";import{s as S}from"../pinia/pinia.81428a33.js";import{t as E,g as w,a as L,u as _,b as x,v as z,e as O,d as T,w as I,x as M,i as P,j as U,y as B,z as A,s as N,A as D,_ as F}from"../../assets/index-933c3f88.js";import{P as q,_ as G}from"../PlayButton/PlayButton.fd3f050e.js";import{T as V}from"../Tab/Tab.e5726de1.js";import{O as H}from"../OnlineBatch/OnlineBatch.129d96f4.js";import{D as J}from"../DecoratedButton/DecoratedButton.d972464c.js";import{M as K}from"../Mv/Mv.f8f9a7b3.js";import{A as W}from"../Albums/Albums.76412682.js";import{P as Z}from"../PlayList/PlayList.b91ab1c9.js";import{S as Q}from"../Singer/Singer.c74f5ca3.js";import{L as X}from"../Loading/Loading.cabc153b.js";import{_ as Y}from"../NoSearch/NoSearch.2874fadd.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";const $={class:"search-container scroll-container"},aa=["src"],sa={class:"right-singer"},ea={class:"singer-name"},la={class:"singer-info"},ia={class:"song"},na={class:"header-operation"},ta={class:"lyric-container"},oa={class:"lyric-operation"},ra=["onClick"],ca=["onClick"],ua=["onClick"],ma=["onClick"],pa=["onClick"],ga={class:"lyric-left"},va={class:"song-name"},da={class:"is-vip iconfont"},ha={class:"lyric-center"},ya={class:"lyric-right"},fa=F(s({__name:"SearchView",setup(s){e((a=>({"3c2c203c":u(ba),"74bdbfaa":u(Ca),"5b1a79c4":u(Ra),"368be78a":u(ja),"2b6b7d1e":u(ka),ebcc60b2:u(Sa)})));const F=E(),{bgMode:fa}=S(F),ba=d("fontGray"),ja=w().get("shadow"),Ra=w().get("fontColor"),Ca=w().get("themeColor"),ka=l((()=>"skin"==fa.value?"rgba(220, 220, 220, 0.1)":"#ffffff"==(null==Ra?void 0:Ra.value)?"rgba(30, 30, 30, 0.2)":"rgba(220, 220, 220, 0.25)")),Sa=l((()=>"skin"==fa.value?"rgba(230, 230, 230, 0.25)":"#ffffff"==(null==Ra?void 0:Ra.value)?"rgba(30, 30, 30, 1)":"rgba(220, 220, 220, 0.8)")),Ea=k(),wa=L(),{loveMusicId:La,loveSongs:_a}=S(wa),xa=i(!1),za=a=>{Ya(),xa.value=a},Oa=()=>{Da.forEach((a=>{a.isLove=!0;null==La.value.get(a.id)&&_a.value.push(a)}))},Ta=_(),{songListId:Ia,songList:Ma,current:Pa,playProcess:Ua,playTime:Ba,isPlay:Aa}=S(Ta),Na=C().query.keyWord+"",Da=n([]),Fa=l((()=>new Map(Da.map(((a,s)=>[a.id,s]))))),qa=n([]),Ga=n([]),Va=n([]),Ha=n([]),Ja=n([]),Ka=n([]),Wa=l((()=>Ka.length>0?Ka[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Za=n([]),Qa=i(!1),Xa=d("firstLoading"),Ya=d("hideScroll"),$a=n([!1,!1,!1,!1,!1,!1,!1]),as=n([]),ss=a=>{Ya(),"video"==a&&0==qa.length?x((async()=>{try{const a=await z(1014,60,Na),{result:{videos:s}}=a;s&&s.length>0&&s.forEach((a=>{const{vid:s,title:e,coverUrl:l,creator:i,playTime:n}=a;qa.push({id:s,name:e,image:l,artist:i[0].userName,playCount:n})}))}catch(a){O(T.ERROR,a.message)}setTimeout((()=>{Qa.value=!1}),500),$a[0]=0==qa.length}),Qa):"mv"==a&&0==Ga.length?x((async()=>{try{const a=await z(1004,60,Na),{result:{mvs:s}}=a;s&&0!=s.length&&s.forEach((a=>{const{id:s,name:e,cover:l,artistName:i,playCount:n}=a;Ga.push({id:s,name:e,image:l,artist:i,playCount:n})}))}catch(a){O(T.ERROR,a.message)}setTimeout((()=>{Qa.value=!1}),500),$a[1]=0==Ga.length}),Qa):"album"==a&&0==Va.length?x((async()=>{try{const a=await z(10,60,Na),{result:{albums:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,publishTime:i,artist:n}=a;Va.push({id:s,name:e,cover:l,publishTime:I(i),artistId:n.id})}))}catch(a){O(T.ERROR,a.message)}setTimeout((()=>{Qa.value=!1}),500),$a[2]=0==Va.length}),Qa):"radio"==a&&0==Ja.length?x((async()=>{try{const a=await z(1009,60,Na),{result:{djRadios:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,playCount:i}=a;Ja.push({name:e,id:s,image:l,playCount:i,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){O(T.ERROR,a.message)}setTimeout((()=>{Qa.value=!1}),500),$a[3]=0==Ja.length}),Qa):"playList"==a&&0==Ha.length?x((async()=>{try{const a=await z(1e3,60,Na),{result:{playlists:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,coverImgUrl:l,playCount:i}=a;Ha.push({id:s,name:e,image:l,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){O(T.ERROR,a.message)}setTimeout((()=>{Qa.value=!1}),500),$a[4]=0==Ha.length}),Qa):"lyric"==a&&0==Za.length&&x((async()=>{try{const a=await z(1006,60,Na),{result:{songs:s}}=a;if(s&&s.length>0){const a=s.map((a=>a.id)).join(","),e=await M(a),{songs:l}=e;l.forEach((a=>{as.push(3),P([],Za,a)})),s.forEach(((a,s)=>{const{lyrics:{txt:e}}=a;Za[s].lyric=e.split("\n")})),U(a,Za),wa.initLoveMusic(Da)}}catch(a){O(T.ERROR,a.message)}setTimeout((()=>{Qa.value=!1}),500),$a[6]=0==Za.length}),Qa)};return x((async()=>{try{const a=await z(1,100,Na),{result:{songs:s}}=a;if(s&&s.length>0){const a=s.map((a=>a.id)).join(","),e=await M(a),{songs:l}=e;l.forEach((a=>{P([],Da,a)})),U(a,Da),wa.initLoveMusic(Da)}}catch(a){O(T.ERROR,a.message)}try{const a=await z(100,60,Na),{result:{artists:s}}=a;s&&s.length>0&&s.forEach((a=>{const{id:s,name:e,picUrl:l,accountId:i,albumSize:n,mvSize:t}=a;Ka.push({id:s,name:e,avatar:l,score:i,albumSize:n,mvSize:t})})),$a[5]=0==Ka.length}catch(a){O(T.ERROR,a.message)}Xa.value=!1}),Xa),(s,e)=>{const l=a,i=R("prevent");return h(),t("div",$,[o(c(H,{songs:Da,"song-id-mapper":u(Fa),onCloseSelect:za},null,8,["songs","song-id-mapper"]),[[r,xa.value]]),o(m("div",{class:"result-singer",onClick:e[1]||(e[1]=a=>u(Ea).push({name:"artist",query:{id:u(Wa).id,score:u(Wa).score}}))},[m("img",{src:u(Wa).avatar,class:"left-singer"},null,8,aa),m("div",sa,[m("h4",ea,"歌手："+p(u(Wa).name),1),m("p",la,[m("span",null,"专辑："+p(u(Wa).albumSize),1),m("span",null,"视频："+p(u(Wa).mvSize),1)])]),c(J,{name:u(Wa).isLove?"取消关注":"关注歌手",icon:u(Wa).isLove?"":"","icon-style":u(Wa).isLove?"color:#ff6a6a;":"",onClick:e[0]||(e[0]=g((a=>u(wa).addLove(u(Wa),u(wa).loveSinger,u(wa).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[r,u(Wa).name]]),o(c(V,{onGetActive:ss,active:"song",class:"search-tab"},{content:v((()=>[c(l,{label:"歌曲",name:"song"},{default:v((()=>[m("div",ia,[m("div",na,[c(q,{songs:Da},null,8,["songs"]),c(J,{icon:"",onClick:Oa,name:"全部收藏"}),c(J,{icon:"",name:"批量操作",onClick:e[2]||(e[2]=a=>xa.value=!xa.value)})]),c(G,{songs:Da,"song-id-mapper":u(Fa)},null,8,["songs","song-id-mapper"])])])),_:1}),c(l,{label:"视频",name:"video"},{default:v((()=>[c(X,{"is-loading":Qa.value},null,8,["is-loading"]),o(c(Y,{text:"暂无搜索结果"},null,512),[[r,$a[0]]]),o(c(K,{mvs:qa},null,8,["mvs"]),[[r,!$a[0]]])])),_:1}),c(l,{label:"MV",name:"mv"},{default:v((()=>[c(X,{"is-loading":Qa.value},null,8,["is-loading"]),o(c(Y,{text:"暂无搜索结果"},null,512),[[r,$a[1]]]),o(c(K,{mvs:Ga},null,8,["mvs"]),[[r,!$a[1]]])])),_:1}),c(l,{label:"专辑",name:"album"},{default:v((()=>[c(X,{"is-loading":Qa.value},null,8,["is-loading"]),o(c(Y,{text:"暂无搜索结果"},null,512),[[r,$a[2]]]),o(c(W,{albums:Va},null,8,["albums"]),[[r,!$a[2]]])])),_:1}),c(l,{label:"电台",name:"radio"},{default:v((()=>[c(X,{"is-loading":Qa.value},null,8,["is-loading"]),o(c(Y,{text:"暂无搜索结果"},null,512),[[r,$a[3]]]),o(c(Z,{playlists:Ja,type:"radio"},null,8,["playlists"]),[[r,!$a[3]]])])),_:1}),c(l,{label:"歌单",name:"playList"},{default:v((()=>[c(X,{"is-loading":Qa.value},null,8,["is-loading"]),o(c(Y,{text:"暂无搜索结果"},null,512),[[r,$a[4]]]),o(c(Z,{playlists:Ha},null,8,["playlists"]),[[r,!$a[4]]])])),_:1}),c(l,{label:"歌手",name:"singer"},{default:v((()=>[c(X,{"is-loading":Qa.value},null,8,["is-loading"]),o(c(Y,{text:"暂无搜索结果"},null,512),[[r,$a[5]]]),o(c(Q,{"singer-list":Ka},null,8,["singer-list"]),[[r,!$a[5]]])])),_:1}),c(l,{label:"歌词",name:"lyric"},{default:v((()=>[c(X,{"is-loading":Qa.value},null,8,["is-loading"]),o(c(Y,{text:"暂无搜索结果"},null,512),[[r,$a[6]]]),m("div",ta,[(h(!0),t(y,null,f(Za,((a,s)=>{var e;return h(),t("div",{class:"lyric",key:a.id},[m("div",oa,[o((h(),t("span",{class:"iconfont play-music",onClick:s=>(async a=>{if("0"==a.available||"8"==a.available){const s=Ia.value.get(a.id);null==s?(wa.addRecord(a,wa.songRecord,wa.loveMusicId),0==Pa.value?(Aa&&(Aa.value=!1),Ua.value=0,Ba.value=0,Ma.value.unshift(a),await j(),Aa.value=!0):(Ma.value.unshift(a),Pa.value=0)):Pa.value!=s?Pa.value=s:Aa.value=!0}else"1"==a.available?O(T.INFO,"此歌曲为vip专属"):"10"==a.available&&O(T.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")})(a)},[b("")],8,ra)),[[i]]),o((h(),t("span",{class:"iconfont music-info",onClick:s=>u(B)(a)},[b("")],8,ca)),[[i]]),o((h(),t("span",{class:"iconfont",onClick:s=>u(A)(a)},[b("")],8,ua)),[[i]]),o((h(),t("span",{class:"open-lyric",onClick:a=>(a=>{as[a]=as[a]==Za[a].lyric.length?3:Za[a].lyric.length})(s)},[b(p(as[s]==(null==(e=a.lyric)?void 0:e.length)?"收起歌词":"展开歌词"),1)],8,ma)),[[i]]),o((h(),t("span",{class:"copy-lyric",onClick:s=>u(N)(a.name+"\r\n"+a.lyric.join("\r\n"),"歌词复制成功！")},[b("复制歌词")],8,pa)),[[i]])]),m("div",ga,[m("p",va,[m("span",null,p(a.name),1),o(m("span",da,"",512),[[r,"10"==a.available||"1"==a.available]])]),(h(!0),t(y,null,f(a.lyric,((a,e)=>o((h(),t("p",{key:e},p(a.trim()),1)),[[r,e<as[s]]]))),128))]),m("div",ha,[m("span",null,p(a.singer),1)]),m("div",ya,[m("span",null,p(a.album),1),m("span",null,p(u(D)(a.time)),1)])])})),128))])])),_:1})])),_:1},512),[[r,!xa.value]])])}}}),[["__scopeId","data-v-f6091d6d"]]);export{fa as default};
