import{g as a,u as s}from"../element-plus/element-plus.372e8740.js";import{G as e,ax as t,d as o,Z as l,i as n,c as i,P as r,V as c,U as m,u as p,a as u,T as d,F as g,a7 as v,M as y,R as h,O as j,o as f,z as _}from"../@vue/@vue.7ad02ad1.js";import{b as S}from"../vue-router/vue-router.47595bf3.js";import{g as C,a as b,b as k,l as w,e as B,d as L,m as P,i as R,j as x,n as O,o as U,C as E,_ as z}from"../../assets/index-a9f97af9.js";import{O as M}from"../OnlineBatch/OnlineBatch.40ca6478.js";import{_ as D}from"../SongList.vue_vue_type_style_index_0_lang/SongList.vue_vue_type_style_index_0_lang.734e9c00.js";import{T as I}from"../Tab/Tab.3a341627.js";import{P as T}from"../PlayButton/PlayButton.15f4d32d.js";import{D as N}from"../DecoratedButton/DecoratedButton.b173897c.js";import{M as A}from"../MoreButton/MoreButton.b09c7ede.js";import{N as F}from"../NoSearch/NoSearch.a832178f.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.8c6d26c7.js";const G={class:"playlist-container scroll-container"},V={class:"header"},$=["src"],q={class:"right"},Z={class:"title"},H={class:"creator"},J={class:"creator-name"},K={class:"tag"},Q={class:"description"},W={class:"header-operation"},X=z(e({__name:"PlayListView",setup(e){t((a=>({"6f6db931":p(z),"34affd4e":p(X),"4e09dcce":p(Y)})));const z=C().get("fontColor"),X=C().get("fontBlack"),Y=C().get("shadow"),aa=o(!1),sa=b(),ea=S(),ta=ea.query.id+"",oa=l({id:ta,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),la=l([]),na=l([]),ia=n((()=>new Map(la.map(((a,s)=>[a.id,s]))))),ra=_("firstLoading"),ca=_("hideScroll"),ma=o(!1),pa=a=>{ma.value=a},ua=a=>{ca(),ma.value=a},da=()=>{navigator.share({url:"https://www.liyinchao.cloud/#"+ea.fullPath,text:"我有一个精品歌单分享给你："+oa.name,title:"歌单分享"}).then((()=>{B(L.SUCCESS,"分享成功！")})).catch((()=>{B(L.SUCCESS,"已取消分享！")}))},ga=()=>{ca()};return k((async()=>{try{const a=await w(ta),{playlist:{name:s,coverImgUrl:e,description:t,tags:o,creator:l,playCount:n}}=a;oa.name=s,oa.image=e,oa.description=t,oa.tag=o,oa.creator.avatarUrl=l.avatarUrl,oa.creator.nickname=l.nickname,oa.playCount=n,sa.initLoveStatus(oa,sa.lovePlaylistId)}catch(a){B(L.ERROR,a.message)}try{const a=await P(ta),{songs:s}=a,e=[];s.forEach((a=>{R(e,la,a)})),sa.initLoveMusic(la),x(e.join(","),la)}catch(a){B(L.ERROR,a.message)}try{const a=await O(ta,100),{comments:s,hotComments:e}=a;U(e,na),U(s,na),aa.value=0==na.length,ra.value=!1}catch(a){B(L.ERROR,a.message)}}),ra),(e,t)=>{const o=a,l=s;return f(),i("div",G,[r(m(M,{"song-id-mapper":p(ia),songs:la,onCloseSelect:pa},null,8,["song-id-mapper","songs"]),[[c,ma.value]]),r(u("div",V,[u("img",{src:oa.image,class:"left-image"},null,8,$),u("div",q,[u("p",Z,d(oa.name),1),u("div",H,[m(o,{src:oa.creator.avatarUrl},null,8,["src"]),u("span",J,d(oa.creator.nickname),1),u("div",K,[(f(!0),i(g,null,v(oa.tag,(a=>(f(),i("span",{key:a},"#"+d(a),1)))),128))])]),u("p",Q,d(oa.description),1),u("div",W,[m(T,{songs:la},null,8,["songs"]),m(N,{name:oa.isLove?"取消收藏":"收藏",icon:oa.isLove?"":"","icon-style":oa.isLove?"color:#ff6a6a;":"",onClick:t[0]||(t[0]=a=>p(sa).addLove(oa,p(sa).lovePlaylist,p(sa).lovePlaylistId,"lovePlaylist"))},null,8,["name","icon","icon-style"]),ma.value?h("",!0):(f(),y(A,{key:0,"share-to":da,onOpenSelect:ua}))])])],512),[[c,!ma.value]]),r(m(I,{active:"song",class:"playlist-tab",onGetActive:ga},{content:j((()=>[m(l,{label:`歌曲 ${la.length}`,name:"song"},{default:j((()=>[m(D,{songs:la,"song-id-mapper":p(ia)},null,8,["songs","song-id-mapper"])])),_:1},8,["label"]),m(l,{label:`评论 ${na.length}`,name:"comment"},{default:j((()=>[aa.value?(f(),y(F,{key:1})):(f(),y(E,{key:0,comments:na},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[c,!ma.value]])])}}}),[["__scopeId","data-v-d82dc900"]]);export{X as default};
