import{g as a,u as e}from"../element-plus/element-plus.a3a17194.js";import{P as s}from"../Pagination/Pagination.9ca352a2.js";import{G as t,ax as o,r as n,Z as l,i,c as r,P as c,V as m,U as p,u,a as g,T as d,F as v,a7 as h,M as y,R as j,O as f,z as R,o as b}from"../@vue/@vue.59fec093.js";import{b as k}from"../vue-router/vue-router.2f940de9.js";import{g as w,a as P,b as C,l as L,e as O,d as U,m as _,i as B,j as z,n as E,o as I,p as M,q as S,r as x,C as D,s as T,_ as q}from"../../assets/index-bd7d6872.js";import{O as G}from"../OnlineBatch/OnlineBatch.4226b54f.js";import{P as F,_ as N}from"../PlayButton/PlayButton.febf1ecc.js";import{T as V}from"../Tab/Tab.b46601e3.js";import{D as $}from"../DecoratedButton/DecoratedButton.3414623a.js";import{M as H}from"../MoreButton/MoreButton.df80252f.js";import{_ as Z}from"../NoSearch/NoSearch.750333ec.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.81428a33.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";const A={class:"playlist-container scroll-container"},J={class:"header"},K=["src"],Q={class:"right"},W={class:"title"},X={class:"creator"},Y={class:"creator-name"},aa={class:"tag"},ea={class:"description"},sa={class:"header-operation"},ta=q(t({__name:"PlayListView",setup(t){o((a=>({"0cc20e7b":u(q),"0cb26f17":u(ta),d33cbe1c:u(oa),"1931684b":u(na)})));const q=w().get("fontColor"),ta=w().get("fontBlack"),oa=w().get("shadow"),na=R("fontGray"),la=n(!1),ia=P(),ra=k(),ca=ra.query.id+"",ma=ra.query.type+"",pa=l({id:ca,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),ua=l([]),ga=l([]),da=i((()=>new Map(ua.map(((a,e)=>[a.id,e]))))),va=n(1),ha=n(40),ya=i((()=>ua.slice((va.value-1)*ha.value,va.value*ha.value))),ja=i((()=>ua.length)),fa=a=>{va.value=a},Ra=R("firstLoading"),ba=n(!1),ka=a=>{ba.value=a},wa=a=>{ba.value=a},Pa=()=>{T("我有一个精品歌单分享给你："+pa.name+"，地址：https://www.liyinchao.cloud/#"+ra.fullPath)},Ca=()=>{"playlist"==ma?ia.addLove(pa,ia.lovePlaylist,ia.lovePlaylistId):ia.addLove(pa,ia.loveRadio,ia.loveRadioId)};return C((async()=>{if("playlist"==ma){try{const a=await L(ca),{playlist:{name:e,coverImgUrl:s,description:t,tags:o,creator:n,playCount:l}}=a;pa.name=e,pa.image=s,pa.description=t,pa.tag=o,pa.creator.avatarUrl=n.avatarUrl,pa.creator.nickname=n.nickname,pa.playCount=l,ia.initLoveStatus(pa,ia.lovePlaylistId)}catch(a){O(U.ERROR,a.message)}try{const a=await _(ca),{songs:e}=a,s=[];e.forEach((a=>{B(s,ua,a)})),ia.initLoveMusic(ua),z(s.join(","),ua)}catch(a){O(U.ERROR,a.message)}try{const a=await E(ca,100),{comments:e,hotComments:s}=a;I(s,ga),I(e,ga),la.value=0==ga.length}catch(a){O(U.ERROR,a.message)}}else{try{const a=await M(ca),{data:{name:e,dj:{avatarUrl:s,nickname:t},picUrl:o,desc:n,subCount:l}}=a;pa.name=e,pa.id=ca,pa.description=n,pa.image=o,pa.playCount=l,pa.creator.nickname=t,pa.creator.avatarUrl=s,ia.initLoveStatus(pa,ia.loveRadioId)}catch(a){O(U.ERROR,a.message)}try{const a=await S(ca,100),{programs:e}=a,s=[];e.forEach((a=>{const{mainSong:{name:e,id:t,fee:o,artists:n,album:{name:l,picUrl:i},duration:r}}=a;s.push(t),ua.push({id:t,name:e,singer:n[0].name,songImage:i,album:l,available:o,time:r})})),ia.initLoveMusic(ua),z(s.join(","),ua)}catch(a){O(U.ERROR,a.message)}x(ca,"7",ga,(()=>{la.value=0==ga.length}))}Ra.value=!1}),Ra),(t,o)=>{const n=a,l=s,i=e;return b(),r("div",A,[c(p(G,{"song-id-mapper":u(da),songs:u(ya),onCloseSelect:ka},null,8,["song-id-mapper","songs"]),[[m,ba.value]]),c(g("div",J,[g("img",{src:pa.image,class:"left-image"},null,8,K),g("div",Q,[g("p",W,d(pa.name),1),g("div",X,[p(n,{src:pa.creator.avatarUrl},null,8,["src"]),g("span",Y,d(pa.creator.nickname),1),g("div",aa,[(b(!0),r(v,null,h(pa.tag,(a=>(b(),r("span",{key:a},"#"+d(a),1)))),128))])]),g("p",ea,d(pa.description),1),g("div",sa,[p(F,{songs:u(ya)},null,8,["songs"]),p($,{name:pa.isLove?"取消收藏":"收藏",icon:pa.isLove?"":"","icon-style":pa.isLove?"color:#ff6a6a;":"",onClick:Ca},null,8,["name","icon","icon-style"]),ba.value?j("",!0):(b(),y(H,{key:0,"share-to":Pa,onOpenSelect:wa}))])])],512),[[m,!ba.value]]),c(p(V,{active:"song",class:"playlist-tab"},{content:f((()=>[p(i,{label:`歌曲 ${ua.length}`,name:"song"},{default:f((()=>[p(N,{songs:u(ya),"song-id-mapper":u(da)},null,8,["songs","song-id-mapper"]),c(p(l,{"cur-page":va.value,"page-size":ha.value,total:u(ja),onPageChange:fa},null,8,["cur-page","page-size","total"]),[[m,ha.value<u(ja)]])])),_:1},8,["label"]),p(i,{label:`评论 ${ga.length<10?ga.length+10:ga.length}`,name:"comment"},{default:f((()=>[la.value?(b(),y(Z,{key:1,size:280,text:"暂无评论数据"})):(b(),y(D,{key:0,comments:ga},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[m,!ba.value]])])}}}),[["__scopeId","data-v-96a39393"]]);export{ta as default};
