import{w as e}from"../element-plus/element-plus.372e8740.js";import{G as a,ax as s,Z as t,d as l,i,P as o,c as u,U as n,u as r,z as v,o as p,ay as c,az as m,a as d,n as h}from"../@vue/@vue.7ad02ad1.js";import{g as j,b as g,k as f,e as y,d as w,_ as C}from"../../assets/index-b6c8c353.js";import{M as G}from"../Mv/Mv.9ee71b7c.js";import{B as z}from"../ButtonGroup/ButtonGroup.4c805645.js";import{S}from"../SearchButton/SearchButton.436d668f.js";import{L as b}from"../Loading/Loading.2db8cd1a.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../vue-router/vue-router.d1338226.js";import"../nprogress/nprogress.8c6d26c7.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";const B=e=>(c("data-v-39ab7a28"),e=e(),m(),e),R=["infinite-scroll-disabled"],x=B((()=>d("h4",{class:"title video-choice"},"视频类型",-1))),E=B((()=>d("h4",{class:"title all"},"全部视频",-1))),L=C(a({__name:"VideoView",setup(a){s((e=>({"7d4874a7":r(c),"7d38d543":r(d),df20e6c2:r(C),"06e8071e":r(m)})));const c=j().get("fontColor"),m=j().get("shadow"),d=j().get("fontBlack"),C=v("fontGray"),B=t(["全部","韩国","日本","欧美","港台","内地"]),L=t(["全部","官方版","现场版","网易出品"]),M=t(["上升最快","最新","最热"]),V=l(0),_=l(0),k=l(0),A=t(new Map),N=t(new Map);let O=t([]),T=t([]);const U=l(200),I=l(30),J=l(!1),K=l(!1),P=v("firstLoading"),Z=v("hideScroll"),q=i((()=>O.filter((e=>e.name.includes(D.value)||e.artist.includes(D.value))))),D=l(""),F=e=>{D.value=e},H=async(e,a)=>{N.set(V.value+""+_.value+k.value,U.value),Z(),O.splice(0),T.splice(0),"视频地区"==a?V.value=e:"视频来源"==a?_.value=e:k.value=e,I.value=40;const s=N.get(V.value+""+_.value+k.value);U.value=s||50,await h();const t=A.get(V.value+""+_.value+k.value);t?(O.push(...t),T.push(...t.slice(0,I.value))):X()},Q=()=>{D.value||(K.value=!0,J.value=!0,I.value+=10,I.value<O.length?setTimeout((()=>{T.push(...O.slice(T.length,I.value)),K.value=!1,J.value=!1}),100):U.value==O.length?(U.value*=2,W()):(T.push(...O.slice(T.length)),K.value=!1,y(w.SUCCESS,"已经到达底部！")))},W=()=>{g((async()=>{try{const e=await f(U.value,B[V.value],L[_.value],M[k.value]),{data:a}=e;a.slice(O.length).forEach((e=>{const{id:a,name:s,cover:t,playCount:l,artistName:i}=e;O.push({id:a,name:s,image:t,playCount:l,artist:i})})),A.set(V.value+""+_.value+k.value,[...O]),T.push(...O.slice(T.length,I.value))}catch(e){y(w.ERROR,e.message)}K.value=!1,J.value=!1}),K)},X=()=>{g((async()=>{try{const e=await f(U.value,B[V.value],L[_.value],M[k.value]),{data:a}=e;a.forEach((e=>{const{id:a,name:s,cover:t,playCount:l,artistName:i}=e;O.push({id:a,name:s,image:t,playCount:l,artist:i})})),A.set(V.value+""+_.value+k.value,[...O]),T.push(...O.slice(0,I.value))}catch(e){y(w.ERROR,e.message)}setTimeout((()=>{P.value=!1}),400)}),P)};return X(),(a,s)=>{const t=e;return o((p(),u("div",{class:"rvideo-container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":J.value,style:{overflow:"auto"}},[n(S,{onGetContent:F}),x,n(z,{onGetActive:H,title:"视频地区",activeValue:0,"show-title":!1,type:B,class:"area"},null,8,["type"]),n(z,{onGetActive:H,title:"视频来源",activeValue:0,"show-title":!1,type:L},null,8,["type"]),n(z,{onGetActive:H,title:"视频排序","show-title":!1,activeValue:0,type:M},null,8,["type"]),E,n(G,{mvs:r(q)},null,8,["mvs"]),n(b,{"is-loading":K.value},null,8,["is-loading"])],8,R)),[[t,Q]])}}}),[["__scopeId","data-v-39ab7a28"]]);export{L as default};
