import{u as a,w as e}from"../element-plus/element-plus.372e8740.js";import{G as l,ax as s,i as t,d as i,Z as n,c as o,U as u,O as r,u as c,z as v,o as m,P as p,F as d,a7 as h,M as g,V as y}from"../@vue/@vue.7ad02ad1.js";import{g as f,p as j,b,E as R,e as E,d as w,F as k,G as C,H as O,f as _,I as x,_ as I}from"../../assets/index-efa453e8.js";import{T as S}from"../Tab/Tab.ad243ee6.js";import{P as T}from"../PlayList/PlayList.3675a70f.js";import{L as U}from"../Loading/Loading.b32d2825.js";import{t as L}from"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../vue-router/vue-router.47595bf3.js";import"../nprogress/nprogress.8c6d26c7.js";const z={class:"music-hall-container"},F=["infinite-scroll-disabled"],G=["infinite-scroll-disabled"],P=["infinite-scroll-disabled"],N=I(l({__name:"MusicHall",setup(l){s((a=>({"1a6e6b84":c(I),"115aafb0":c(H),"7c685cb5":c(N),"136bd7dd":J.value,"7d284b72":c(A),"3d318900":V.value})));const I=f().get("fontColor"),N=f().get("shadow"),H=v("fontGray"),M=j(),A=t((()=>M.isFullScreen?"76.3vh":"73.3vh")),J=i("0px"),V=i("none"),Z=()=>{V.value="none",J.value="0"};let q=0;const B=L((()=>{"block"!=V.value&&(V.value="block",J.value="6px"),q&&clearTimeout(q),q=setTimeout((()=>{"none"!=V.value&&Z()}),3e3)}),600,{leading:!0,trailing:!1}),D=v("firstLoading"),K=i(!1),Q=n([]),W=n([]),X=n([]),Y=i(18),$=i(0),aa=i(!1),ea=async()=>{try{const a=await O(100,X[$.value]),{playlists:e}=a;e.forEach((a=>{const{name:e,id:l,coverImgUrl:s,playCount:t}=a;Q[$.value].push({name:e,id:l,image:s,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(a){E(w.ERROR,a.message)}0==$.value&&(W[$.value].push(...Q[$.value].slice(0,Y.value)),D.value=!1),K.value&&(K.value=!1)},la=()=>{aa.value=!0,Y.value+=12,Y.value<Q[$.value].length?setTimeout((()=>{W[$.value].push(...Q[$.value].slice(Y.value-12,Y.value)),aa.value=!1}),100):(K.value=!0,$.value<X.length?(Y.value=0,W[$.value].push(...Q[$.value].slice(W[$.value].length)),$.value++,ea(),aa.value=!1):(K.value=!1,E(w.INFO,"已经到底部啦！")))},sa=n([]),ta=n([]),ia=n([]),na=i(18),oa=i(0),ua=i(!1),ra=async()=>{try{const a=await _(100,ia[oa.value]),{playlists:e}=a;e.forEach((a=>{const{name:e,id:l,coverImgUrl:s,playCount:t}=a;sa[oa.value].push({name:e,id:l,image:s,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(a){E(w.ERROR,a.message)}0==oa.value&&(ta[oa.value].push(...sa[oa.value].slice(0,na.value)),D.value=!1),K.value&&(K.value=!1)},ca=()=>{ua.value=!0,na.value+=12,na.value<sa[$.value].length?setTimeout((()=>{ta[oa.value].push(...sa[oa.value].slice(na.value-12,na.value)),ua.value=!1}),100):(K.value=!0,oa.value<ia.length?(na.value=0,ta[oa.value].push(...sa[oa.value].slice(ta[oa.value].length)),oa.value++,ra(),ua.value=!1):(K.value=!1,E(w.INFO,"已经到底部啦！")))},va=n([]),ma=n([]),pa=i(0),da=i(!1),ha=()=>{da.value=!0,K.value=!0,pa.value++,pa.value<ma.length?(ga(),da.value=!1):(E(w.SUCCESS,"已经到达底部啦！"),K.value=!1)},ga=async()=>{try{const a=await x(ma[pa.value].id),{data:{playlist:e}}=a;e.forEach((a=>{const{id:e,name:l,cover:s,playCount:t}=a;va[pa.value].push({id:e,name:l,image:s,playCount:t,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){E(w.ERROR,a.message)}0==pa.value&&(D.value=!1),K.value&&(K.value=!1)},ya=a=>{Z(),"rec"==a&&0==sa[0].length?(D.value=!0,ra()):"style"==a&&0==va[0].length&&(D.value=!0,ga())};return b((async()=>{try{const a=await R(),{tags:e}=a;X.push(...e.map((a=>a.name))),X.forEach((a=>{Q.push([]),W.push([])}))}catch(a){E(w.ERROR,a.message)}try{const a=await k(),{sub:e}=a;ia.push(...e.map((a=>a.name))),ia.forEach((a=>{sa.push([]),ta.push([])}))}catch(a){E(w.ERROR,a.message)}try{const a=await C(),{data:e}=a;e.forEach((a=>{const{tagId:e,tagName:l}=a;ma.push({id:e,name:l}),va.push([])}))}catch(a){E(w.ERROR,a.message)}ea()}),D),(l,s)=>{const t=a,i=e;return m(),o("div",z,[u(S,{active:"top",onGetActive:ya},{content:r((()=>[u(t,{label:"精选歌单",name:"top"},{default:r((()=>[p((m(),o("div",{class:"container scroll-container",onScroll:s[0]||(s[0]=a=>c(B)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":aa.value,style:{overflow:"auto"}},[(m(!0),o(d,null,h(W,((a,e)=>p((m(),g(T,{key:X[e],title:X[e],playlists:a},null,8,["title","playlists"])),[[y,a.length>0]]))),128)),u(U,{"is-loading":K.value},null,8,["is-loading"])],40,F)),[[i,la]])])),_:1}),u(t,{label:"网友推荐",name:"rec"},{default:r((()=>[p((m(),o("div",{class:"container scroll-container",onScroll:s[1]||(s[1]=a=>c(B)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ua.value,style:{overflow:"auto"}},[(m(!0),o(d,null,h(ta,((a,e)=>p((m(),g(T,{key:ia[e],title:ia[e],playlists:a},null,8,["title","playlists"])),[[y,a.length>0]]))),128)),u(U,{"is-loading":K.value},null,8,["is-loading"])],40,G)),[[i,ca]])])),_:1}),u(t,{label:"浪漫曲风",name:"style"},{default:r((()=>[p((m(),o("div",{class:"container scroll-container",onScroll:s[2]||(s[2]=a=>c(B)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":da.value,style:{overflow:"auto"}},[(m(!0),o(d,null,h(va,((a,e)=>p((m(),g(T,{key:ma[e].id,title:ma[e].name,playlists:a},null,8,["title","playlists"])),[[y,a.length>0]]))),128)),u(U,{"is-loading":K.value},null,8,["is-loading"])],40,P)),[[i,ha]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-5acba248"]]);export{N as default};
