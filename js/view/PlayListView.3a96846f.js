import{g as a,u as e}from"../element-plus/element-plus.ec47f34a.js";import{G as s,ax as t,d as o,Z as n,i,c as l,P as r,V as m,U as c,u as p,a as u,T as d,F as g,a7 as v,M as y,R as h,O as j,z as f,o as _}from"../@vue/@vue.7ad02ad1.js";import{b as R}from"../vue-router/vue-router.47595bf3.js";import{g as b,a as k,b as w,l as L,e as C,d as O,m as S,i as U,j as B,n as P,o as x,p as E,q as I,r as M,C as z,s as D,_ as G}from"../../assets/index-a64598ed.js";import{O as T}from"../OnlineBatch/OnlineBatch.5011fa0a.js";import{_ as q}from"../SongList.vue_vue_type_style_index_0_lang/SongList.vue_vue_type_style_index_0_lang.6a6b0b73.js";import{T as F}from"../Tab/Tab.4edd7eb4.js";import{P as N}from"../PlayButton/PlayButton.cd89caf4.js";import{D as V}from"../DecoratedButton/DecoratedButton.733dc12e.js";import{M as $}from"../MoreButton/MoreButton.85fe5ff6.js";import{_ as A}from"../NoSearch/NoSearch.e46bbd69.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";const H={class:"playlist-container scroll-container"},Z={class:"header"},J=["src"],K={class:"right"},Q={class:"title"},W={class:"creator"},X={class:"creator-name"},Y={class:"tag"},aa={class:"description"},ea={class:"header-operation"},sa=G(s({__name:"PlayListView",setup(s){t((a=>({"376491bc":p(G),"3754f258":p(sa),"7df7b79a":p(ta),"4efe0e2c":p(oa)})));const G=b().get("fontColor"),sa=b().get("fontBlack"),ta=b().get("shadow"),oa=f("fontGray"),na=o(!1),ia=k(),la=R(),ra=la.query.id+"",ma=la.query.type+"",ca=n({id:ra,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),pa=n([]),ua=n([]),da=i((()=>new Map(pa.map(((a,e)=>[a.id,e]))))),ga=f("firstLoading"),va=f("hideScroll"),ya=o(!1),ha=a=>{ya.value=a},ja=a=>{va(),ya.value=a},fa=()=>{D("我有一个精品歌单分享给你："+ca.name+"，地址：https://www.liyinchao.cloud/#"+la.fullPath)},_a=()=>{"playlist"==ma?ia.addLove(ca,ia.lovePlaylist,ia.lovePlaylistId):ia.addLove(ca,ia.loveRadio,ia.loveRadioId)},Ra=()=>{va()};return w((async()=>{if("playlist"==ma){try{const a=await L(ra),{playlist:{name:e,coverImgUrl:s,description:t,tags:o,creator:n,playCount:i}}=a;ca.name=e,ca.image=s,ca.description=t,ca.tag=o,ca.creator.avatarUrl=n.avatarUrl,ca.creator.nickname=n.nickname,ca.playCount=i,ia.initLoveStatus(ca,ia.lovePlaylistId)}catch(a){C(O.ERROR,a.message)}try{const a=await S(ra),{songs:e}=a,s=[];e.forEach((a=>{U(s,pa,a)})),ia.initLoveMusic(pa),B(s.join(","),pa)}catch(a){C(O.ERROR,a.message)}try{const a=await P(ra,100),{comments:e,hotComments:s}=a;x(s,ua),x(e,ua),na.value=0==ua.length}catch(a){C(O.ERROR,a.message)}}else{try{const a=await E(ra),{data:{name:e,dj:{avatarUrl:s,nickname:t},picUrl:o,desc:n,subCount:i}}=a;ca.name=e,ca.id=ra,ca.description=n,ca.image=o,ca.playCount=i,ca.creator.nickname=t,ca.creator.avatarUrl=s,ia.initLoveStatus(ca,ia.loveRadioId)}catch(a){C(O.ERROR,a.message)}try{const a=await I(ra,100),{programs:e}=a,s=[];e.forEach((a=>{const{mainSong:{name:e,id:t,fee:o,artists:n,album:{name:i,picUrl:l},duration:r}}=a;s.push(t),pa.push({id:t,name:e,singer:n[0].name,songImage:l,album:i,available:o,time:r})})),ia.initLoveMusic(pa),B(s.join(","),pa)}catch(a){C(O.ERROR,a.message)}M(ra,"7",ua,(()=>{na.value=0==ua.length}))}ga.value=!1}),ga),(s,t)=>{const o=a,n=e;return _(),l("div",H,[r(c(T,{"song-id-mapper":p(da),songs:pa,onCloseSelect:ha},null,8,["song-id-mapper","songs"]),[[m,ya.value]]),r(u("div",Z,[u("img",{src:ca.image,class:"left-image"},null,8,J),u("div",K,[u("p",Q,d(ca.name),1),u("div",W,[c(o,{src:ca.creator.avatarUrl},null,8,["src"]),u("span",X,d(ca.creator.nickname),1),u("div",Y,[(_(!0),l(g,null,v(ca.tag,(a=>(_(),l("span",{key:a},"#"+d(a),1)))),128))])]),u("p",aa,d(ca.description),1),u("div",ea,[c(N,{songs:pa},null,8,["songs"]),c(V,{name:ca.isLove?"取消收藏":"收藏",icon:ca.isLove?"":"","icon-style":ca.isLove?"color:#ff6a6a;":"",onClick:_a},null,8,["name","icon","icon-style"]),ya.value?h("",!0):(_(),y($,{key:0,"share-to":fa,onOpenSelect:ja}))])])],512),[[m,!ya.value]]),r(c(F,{active:"song",class:"playlist-tab",onGetActive:Ra},{content:j((()=>[c(n,{label:`歌曲 ${pa.length}`,name:"song"},{default:j((()=>[c(q,{songs:pa,"song-id-mapper":p(da)},null,8,["songs","song-id-mapper"])])),_:1},8,["label"]),c(n,{label:`评论 ${ua.length<10?ua.length+10:ua.length}`,name:"comment"},{default:j((()=>[na.value?(_(),y(A,{key:1,size:280,text:"暂无评论数据"})):(_(),y(z,{key:0,comments:ua},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[m,!ya.value]])])}}}),[["__scopeId","data-v-b637e1fd"]]);export{sa as default};
