import{u as e}from"../element-plus/element-plus.372e8740.js";import{G as s,ax as a,i as o,d as l,Z as t,c as n,U as i,O as u,u as r,o as m,P as c,V as p,a as v,z as d,n as f}from"../@vue/@vue.7ad02ad1.js";import{g as j,a as g,u as h,c as _,l as S,f as y,h as C,e as w,s as D,_ as L}from"../../assets/index-aba7f600.js";import{T as x}from"../Tab/Tab.358c1c9c.js";import{P as b}from"../PlayButton/PlayButton.814eb13b.js";import{D as k}from"../DecoratedButton/DecoratedButton.95a3f5e5.js";import{_ as B}from"../SongList.vue_vue_type_style_index_0_lang/SongList.vue_vue_type_style_index_0_lang.dbf25251.js";import{S as z}from"../SearchButton/SearchButton.35cc32cb.js";import{M as I}from"../Mv/Mv.f9d0f3d8.js";import{s as O}from"../pinia/pinia.07d51cb2.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.6b07a04c.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../axios/axios.d4208f68.js";import"../vue-router/vue-router.53ff932e.js";import"../nprogress/nprogress.8c6d26c7.js";const P={class:"download-container scroll-container"},A={class:"top-operation"},E={class:"top-operation operation-select"},G=L(s({__name:"DownloadView",setup(s){a((e=>({cf5849f6:r(L)})));const L=j().get("fontColor"),G=g(),{mvDownload:M,musicDownload:T}=O(G),U=h(),{isPlay:N,songList:F,songListId:V,playProcess:H,playTime:Z,current:q}=O(U),J=o((()=>T.value.filter((e=>e.name.includes(K.value)||e.album.includes(K.value)||e.singer.includes(K.value))))),K=l(""),Q=d("firstLoading"),R=d("hideScroll"),W=()=>{R()},X=e=>{K.value=e},Y=l(!1);let $=t([]);const ee=e=>{$=t([]),$.push(...e)},se=async()=>{$.length>0?(N.value=!1,H.value=0,Z.value=0,await f(),$.forEach((e=>{null==V.value.get(e.id)&&F.value.unshift(e)})),q.value=V.value.get($[0].id),N.value=!0,y(C.SUCCESS,"已添加到播放列表！")):y(C.INFO,"请添加歌曲！")},ae=()=>{$.forEach((e=>{G.addMuiscDownload(e)}))},oe=()=>{if($.length>0){const e=$.map((e=>e.id)),s=T.value.filter((s=>!e.includes(s.id)));T.value.splice(0),T.value.push(...s),w(D.LOCAL,"musicDownload",T.value),y(C.SUCCESS,"已清除选中的歌曲！")}else y(C.INFO,"请添加歌曲！")},le=()=>{T.value.splice(0),w(D.LOCAL,"musicDownload",T.value),y(C.SUCCESS,"已清空全部下载记录！")},te=e=>{M.value.splice(e,1),w(D.LOCAL,"mvDownload",M)};return _((async()=>{const e=T.value.map((e=>e.id)).join(",");S(e,T.value),G.initLoveMusic(T.value),Q.value=!1}),Q),(s,a)=>{const o=e;return m(),n("div",P,[i(x,{active:"song",onGetActive:W},{content:u((()=>[i(o,{label:"下载歌曲",name:"song"},{default:u((()=>[c(v("div",A,[i(b,{songs:r(T)},null,8,["songs"]),i(k,{icon:"",name:"清空下载记录",onClick:le}),i(k,{icon:"",name:"批量操作",onClick:a[0]||(a[0]=e=>Y.value=!Y.value)}),i(z,{onGetContent:X})],512),[[p,!Y.value]]),c(v("div",E,[i(k,{icon:"",name:"播放",class:"play",onClick:se}),i(k,{icon:"",onClick:oe,name:"删除"}),i(k,{icon:"󰌄",onClick:ae,name:"下载"}),i(k,{icon:"",name:"取消操作",onClick:a[1]||(a[1]=e=>Y.value=!Y.value)})],512),[[p,Y.value]]),i(B,{songs:r(J),showSelect:Y.value,onGetSelectItems:ee,height:"440px"},null,8,["songs","showSelect"])])),_:1}),i(o,{label:"下载视频",name:"video "},{default:u((()=>[i(I,{mvs:r(M),"show-delete":!0,transitionName:"list",onGetDeleteIndex:te},null,8,["mvs"])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-ff6be45b"]]);export{G as default};
