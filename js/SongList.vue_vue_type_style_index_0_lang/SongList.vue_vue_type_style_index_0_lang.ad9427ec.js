import{y as e,z as a}from"../element-plus/element-plus.372e8740.js";import{G as o,ax as s,u as l,d as t,Z as n,i,e as r,o as d,M as c,O as u,R as v,U as p,a as m,a2 as g,I as h,T as w,c as f,P as b,S as y,V as C,z as I,n as S,aq as k}from"../@vue/@vue.7ad02ad1.js";import{g as x,u as M,a as L,K as j,L as _,e as R,d as B,M as H,j as N}from"../../assets/index-436cfb30.js";import{s as O}from"../pinia/pinia.07d51cb2.js";import{o as P}from"../vue-router/vue-router.53ff932e.js";const q=["onMousedown","textContent"],z={key:0,class:"iconfont vip"},D=["onClick"],F=["onClick"],T=["onClick"],A=o({__name:"SongList",props:{songs:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(o,{emit:A}){const E=o;s((e=>({"292a5e93":l(G),"2970f86c":l(U),"35eeab15":l(K)})));const G=x().get("fontColor"),K=x().get("background"),U=x().get("tableHover"),V=I("hideScroll"),Z=M(),{songList:J,current:Q,isPlay:W,playProcess:X,playTime:Y,songListId:$}=O(Z),ee=L(),ae=t(),oe=t("operation-area operation"+Number.parseInt(1e12*Math.random()+"")),se=n(new Map),le=i((()=>E.showSelect)),te=i((()=>E.showSelect?55:0)),ne=e=>{A("getSelectItems",e)};r(le,(e=>{e||ae.value.clearSelection()}));const ie=i((()=>E.sort?E.sort:[!1,!1,!1,!1])),re=i((()=>E.isCancelSort)),de=(e,a)=>e.name.localeCompare(a.name),ce=(e,a)=>e.singer.localeCompare(a.singer),ue=(e,a)=>e.album.localeCompare(a.album),ve=(e,a)=>+e.time-+a.name;r(re,(e=>{e&&ae.value.clearSort()}));const pe=()=>document.querySelectorAll("."+oe.value.split(" ")[1]),me=e=>{if(se.get(e.id))pe()[se.get(e.id)].style.opacity="1";else{const a=E.songs.findIndex((a=>a.id==e.id));se.set(e.id,a),pe()[a].style.opacity="1"}},ge=e=>{if(se.get(e.id))pe()[se.get(e.id)].style.opacity="0";else{const a=E.songs.findIndex((a=>a.id==e.id));se.set(e.id,a),pe()[a].style.opacity="0"}},he=async e=>{if("0"==e.available||"8"==e.available){const a=$.value.get(e.id);null==a?(ee.addRecord(e,ee.songRecord,ee.songRecordId,"songRecord"),0==Q.value?(W&&(W.value=!1),X.value=0,Y.value=0,J.value.unshift(e),await S(),W.value=!0):(J.value.unshift(e),Q.value=0)):Q.value!=a?Q.value=a:W.value=!0}else(e.available="1")?R(B.INFO,"此歌曲为vip专属"):(e.available="10")&&R(B.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let we=0;return we=setInterval((()=>{const e=E.songs.map((e=>e.id)),a=E.songs.findIndex((e=>e.id==J.value[Q.value].id));e.length>0&&N(e.join(","),E.songs,"",a)}),3e5),P((()=>{clearInterval(we)})),(s,t)=>{const n=a,i=k("prevent");return d(),c(l(e),{onCellDblclick:he,onCellMouseEnter:me,onCellMouseLeave:ge,onSelectionChange:ne,data:o.songs,"max-height":o.height,"show-header":o.showHeader,ref_key:"tableContainer",ref:ae,style:{width:"80vw"},class:"songs-table"},{default:u((()=>[l(le)?(d(),c(n,{key:0,type:"selection",width:l(te)},null,8,["width"])):v("",!0),p(n,{sortable:l(ie)[0],"sort-method":de,label:"歌曲",width:500-l(te)},{default:u((e=>[m("div",null,[m("span",{onMousedown:g((a=>l(ee).addLove(e.row,l(ee).loveSongs,l(ee).loveMusicId,"loveSongs")),["prevent"]),class:h(["iconfont love",{"is-love":e.row.isLove}]),textContent:w(e.row.isLove?"󰅅":"")},null,42,q),m("span",null,w(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(d(),f("span",z,"")):v("",!0),b((d(),f("span",{class:"iconfont playmv",onClick:a=>{return o=e.row,void H(o,(()=>{V()}));var o}},[y("")],8,D)),[[i]]),m("div",{class:h(oe.value)},[b((d(),f("span",{onClick:a=>he(e.row),class:"iconfont"},[y("")],8,F)),[[C,!l(W)||l(Q)!=l(J).findIndex((a=>a.id==e.row.id))],[i]]),b((d(),f("span",{onClick:t[0]||(t[0]=e=>W.value=!1),class:"iconfont"},[y(" ")])),[[C,l(W)&&l(Q)==l(J).findIndex((a=>a.id==e.row.id))],[i]]),b((d(),f("span",{class:"iconfont",onClick:a=>l(ee).addMuiscDownload(e.row)},[y("󰌄")],8,T)),[[i]]),p(j,{song:e.row,play:he},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),p(n,{sortable:l(ie)[1],"sort-method":ce,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),p(n,{sortable:l(ie)[2],"sort-method":ue,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),p(n,{sortable:l(ie)[3],"sort-method":ve,label:"时长"},{default:u((e=>[m("span",null,w(l(_)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header"])}}});export{A as _};
