import{y as e,z as a}from"../element-plus/element-plus.372e8740.js";import{G as s,ax as l,u as o,d as n,i as t,e as i,o as r,M as d,O as c,R as u,U as v,a as p,a2 as g,I as f,T as w,c as m,P as y,S as h,V as b,z as C,n as I,aq as S}from"../@vue/@vue.7ad02ad1.js";import{g as k,u as x,a as L,L as M,M as _,f as j,h as P,N as R,l as q}from"../../assets/index-14a940fb.js";import{s as N}from"../pinia/pinia.07d51cb2.js";import{o as O}from"../vue-router/vue-router.53ff932e.js";const z=["onMousedown","textContent"],A={key:0,class:"iconfont vip"},B=["onClick"],D={class:"operation"},F=["onClick"],T=["onClick"],E=s({__name:"SongList",props:{songs:null,height:null,isPlaylist:{type:Boolean,default:!1},showSelect:{type:Boolean}},emits:["getSelectItems"],setup(s,{emit:E}){const G=s;l((e=>({"185f8404":o(H),"18a61ddd":o(V),"3823e344":o(U)})));const H=k().get("fontColor"),U=k().get("background"),V=k().get("tableHover"),J=C("hideScroll"),K=x(),{songList:Q,current:W,isPlay:X,playProcess:Y,playTime:Z,songListId:$}=N(K),ee=L(),ae=n(),se=t((()=>G.showSelect)),le=t((()=>G.showSelect?55:0)),oe=e=>{E("getSelectItems",e)},ne=e=>{const a=G.songs.findIndex((a=>a.id==e.id)),s=document.querySelectorAll(".operation");G.isPlaylist?s[a+1].style.opacity="1":s[a].style.opacity="1"},te=e=>{const a=G.songs.findIndex((a=>a.id==e.id)),s=document.querySelectorAll(".operation");G.isPlaylist?s[a+1].style.opacity="0":s[a].style.opacity="0"},ie=async e=>{if("0"==e.available||"8"==e.available){const a=$.value.get(e.id);null==a?(ee.addRecord(e,ee.songRecord,ee.songRecordId,"songRecord"),0==W.value?(X&&(X.value=!1),Y.value=0,Z.value=0,Q.value.unshift(e),await I(),X.value=!0):(Q.value.unshift(e),W.value=0)):W.value!=a?W.value=a:X.value=!0}else(e.available="1")?j(P.INFO,"此歌曲为vip专属"):(e.available="10")&&j(P.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let re=0;return re=setInterval((()=>{const e=G.songs.map((e=>e.id)),a=G.songs.findIndex((e=>e.id==Q.value[W.value].id));e.length>0&&q(e.join(","),G.songs,"",a)}),3e5),O((()=>{clearInterval(re)})),i(se,(e=>{e||ae.value.clearSelection()})),(l,n)=>{const t=a,i=S("prevent");return r(),d(o(e),{onCellDblclick:ie,onCellMouseEnter:ne,onCellMouseLeave:te,onSelectionChange:oe,data:s.songs,"max-height":s.height,ref_key:"tableContainer",ref:ae,style:{width:"80vw"},class:"songs-table"},{default:c((()=>[o(se)?(r(),d(t,{key:0,type:"selection",width:o(le)},null,8,["width"])):u("",!0),v(t,{label:"歌曲",width:500-o(le)},{default:c((e=>[p("div",null,[p("span",{onMousedown:g((a=>o(ee).addLove(e.row,o(ee).loveSongs,o(ee).loveMusicId,"loveSongs")),["prevent"]),class:f(["iconfont love",{"is-love":e.row.isLove}]),textContent:w(e.row.isLove?"󰅅":"")},null,42,z),p("span",null,w(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(r(),m("span",A,"")):u("",!0),y((r(),m("span",{class:"iconfont playmv",onClick:a=>{return s=e.row,void R(s,(()=>{J()}));var s}},[h("")],8,B)),[[i]]),p("div",D,[y((r(),m("span",{onClick:a=>ie(e.row),class:"iconfont"},[h("")],8,F)),[[b,!o(X)||o(W)!=o(Q).findIndex((a=>a.id==e.row.id))],[i]]),y((r(),m("span",{onClick:n[0]||(n[0]=e=>X.value=!1),class:"iconfont"},[h(" ")])),[[b,o(X)&&o(W)==o(Q).findIndex((a=>a.id==e.row.id))],[i]]),y((r(),m("span",{class:"iconfont",onClick:a=>o(ee).addMuiscDownload(e.row)},[h("󰌄")],8,T)),[[i]]),v(M,{song:e.row,play:ie},null,8,["song"])])])])),_:1},8,["width"]),v(t,{prop:"singer",label:"歌手",width:"320"}),v(t,{prop:"album",label:"专辑",width:"320"}),v(t,{label:"时长"},{default:c((e=>[p("span",null,w(o(_)(e.row.time)),1)])),_:1})])),_:1},8,["data","max-height"])}}});export{E as _};
