import{y as e,z as a}from"../element-plus/element-plus.372e8740.js";import{G as o,ax as s,d as l,i as t,e as n,M as r,O as i,I as d,u,z as c,n as p,o as v,R as m,U as g,a as h,a2 as w,T as b,c as f,P as y,S as C,V as I,aq as k}from"../@vue/@vue.7ad02ad1.js";import{s as S}from"../pinia/pinia.07d51cb2.js";import{o as M}from"../vue-router/vue-router.47595bf3.js";import{p as x,g as j,u as L,a as _,e as R,d as B,j as H,Q as N,R as O,T as P}from"../../assets/index-f2c2582e.js";const T=["onMousedown","textContent"],q={key:0,class:"iconfont vip"},z=["onClick"],D=["onClick"],F=["onClick"],G=o({__name:"SongList",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(o,{emit:G}){const A=o;s((e=>({"31fe65fe":u(U),be9d2f2e:u(V),"4ce38438":u(J),"287dc105":u(K)})));const E=x(),{bgMode:Q}=S(E),U=j().get("fontColor"),V=j().get("tableHover"),J=j().get("background"),K=c("fontGray"),W=c("hideScroll"),X=L(),{songList:Y,current:Z,isPlay:$,playProcess:ee,playTime:ae,songListId:oe}=S(X),se=_(),le=l(),te=l("operation-area operation"+Number.parseInt(1e12*Math.random()+"")),ne=t((()=>A.showSelect)),re=t((()=>A.showSelect?55:0)),ie=e=>{G("getSelectItems",e)};n(ne,(e=>{e||le.value.clearSelection()}));const de=t((()=>A.sort?A.sort:[!1,!1,!1,!1])),ue=t((()=>A.isCancelSort)),ce=(e,a)=>e.name.localeCompare(a.name),pe=(e,a)=>e.singer.localeCompare(a.singer),ve=(e,a)=>e.album.localeCompare(a.album),me=(e,a)=>+e.time-+a.name;n(ue,(e=>{e&&le.value.clearSort()}));const ge=()=>document.querySelectorAll("."+te.value.split(" ")[1]),he=e=>{ge()[A.songIdMapper.get(e.id)].style.opacity="1"},we=e=>{ge()[A.songIdMapper.get(e.id)].style.opacity="0"},be=async e=>{if("0"==e.available||"8"==e.available){const a=oe.value.get(e.id);null==a?(se.addRecord(e,se.songRecord,se.songRecordId),0==Z.value?($&&($.value=!1),ee.value=0,ae.value=0,Y.value.unshift(e),await p(),$.value=!0):(Y.value.unshift(e),Z.value=0)):Z.value!=a?Z.value=a:$.value=!0}else(e.available="1")?R(B.INFO,"此歌曲为vip专属"):(e.available="10")&&R(B.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let fe=0;return fe=setInterval((()=>{const e=A.songs.map((e=>e.id)),a=A.songs.findIndex((e=>e.id==Y.value[Z.value].id));e.length>0&&H(e.join(","),A.songs,"",a)}),3e5),M((()=>{clearInterval(fe)})),(s,l)=>{const t=a,n=k("prevent");return v(),r(u(e),{onCellDblclick:be,onCellMouseEnter:he,onCellMouseLeave:we,onSelectionChange:ie,data:o.songs,"max-height":o.height,"show-header":o.showHeader,ref_key:"tableContainer",ref:le,style:{width:"80vw"},class:d(["songs-table",{"skin-table":"skin"==u(Q)}])},{default:i((()=>[u(ne)?(v(),r(t,{key:0,type:"selection",width:u(re)},null,8,["width"])):m("",!0),g(t,{sortable:u(de)[0],"sort-method":ce,label:"歌曲",width:500-u(re)},{default:i((e=>[h("div",null,[h("span",{onMousedown:w((a=>u(se).addLove(e.row,u(se).loveSongs,u(se).loveMusicId)),["prevent"]),class:d(["iconfont love",{"is-love":e.row.isLove}]),textContent:b(e.row.isLove?"󰅅":"")},null,42,T),h("span",null,b(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(v(),f("span",q,"")):m("",!0),y((v(),f("span",{class:"iconfont playmv",onClick:a=>{return o=e.row,void P(o,(()=>{W()}));var o}},[C("")],8,z)),[[n]]),h("div",{class:d(te.value)},[y((v(),f("span",{onClick:a=>be(e.row),class:"iconfont"},[C("")],8,D)),[[I,!u($)||u(Z)!=u(Y).findIndex((a=>a.id==e.row.id))],[n]]),y((v(),f("span",{onClick:l[0]||(l[0]=e=>$.value=!1),class:"iconfont"},[C(" ")])),[[I,u($)&&u(Z)==u(Y).findIndex((a=>a.id==e.row.id))],[n]]),y((v(),f("span",{class:"iconfont",onClick:a=>u(se).addMuiscDownload(e.row)},[C("󰌄")],8,F)),[[n]]),g(N,{song:e.row,play:be},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),g(t,{sortable:u(de)[1],"sort-method":pe,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),g(t,{sortable:u(de)[2],"sort-method":ve,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),g(t,{sortable:u(de)[3],"sort-method":me,label:"时长"},{default:i((e=>[h("span",null,b(u(O)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header","class"])}}});export{G as _};
