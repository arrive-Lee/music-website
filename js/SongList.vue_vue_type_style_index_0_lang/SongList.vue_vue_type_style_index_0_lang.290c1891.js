import{y as e,z as a}from"../element-plus/element-plus.372e8740.js";import{G as o,ax as s,u as l,d as t,i as n,e as i,o as r,M as c,O as d,R as u,U as v,a as p,a2 as m,I as g,T as f,c as h,P as w,S as y,V as b,z as C,n as S,aq as I}from"../@vue/@vue.7ad02ad1.js";import{g as k,u as x,a as L,L as M,M as _,f as j,h as P,N as R,l as q}from"../../assets/index-725a1ee5.js";import{s as B}from"../pinia/pinia.07d51cb2.js";import{o as N}from"../vue-router/vue-router.53ff932e.js";const O=["onMousedown","textContent"],z={key:0,class:"iconfont vip"},A=["onClick"],D={class:"operation"},F=["onClick"],T=["onClick"],E=o({__name:"SongList",props:{songs:null,height:null,isPlaylist:{type:Boolean,default:!1},showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1}},emits:["getSelectItems"],setup(o,{emit:E}){const G=o;s((e=>({"6d320297":l(H),"6d789c70":l(V),"17d52591":l(U)})));const H=k().get("fontColor"),U=k().get("background"),V=k().get("tableHover"),J=C("hideScroll"),K=x(),{songList:Q,current:W,isPlay:X,playProcess:Y,playTime:Z,songListId:$}=B(K),ee=L(),ae=t(),oe=n((()=>G.showSelect)),se=n((()=>G.showSelect?55:0)),le=e=>{E("getSelectItems",e)};i(oe,(e=>{e||ae.value.clearSelection()}));const te=n((()=>G.sort?G.sort:[!1,!1,!1,!1])),ne=n((()=>G.isCancelSort));i(ne,(e=>{e&&ae.value.clearSort()}));const ie=(e,a)=>e.name.localeCompare(a.name),re=(e,a)=>e.singer.localeCompare(a.singer),ce=(e,a)=>e.album.localeCompare(a.album),de=(e,a)=>+e.time-+a.name,ue=e=>{const a=G.songs.findIndex((a=>a.id==e.id)),o=document.querySelectorAll(".operation");G.isPlaylist?o[a+1].style.opacity="1":o[a].style.opacity="1"},ve=e=>{const a=G.songs.findIndex((a=>a.id==e.id)),o=document.querySelectorAll(".operation");G.isPlaylist?o[a+1].style.opacity="0":o[a].style.opacity="0"},pe=async e=>{if("0"==e.available||"8"==e.available){const a=$.value.get(e.id);null==a?(ee.addRecord(e,ee.songRecord,ee.songRecordId,"songRecord"),0==W.value?(X&&(X.value=!1),Y.value=0,Z.value=0,Q.value.unshift(e),await S(),X.value=!0):(Q.value.unshift(e),W.value=0)):W.value!=a?W.value=a:X.value=!0}else(e.available="1")?j(P.INFO,"此歌曲为vip专属"):(e.available="10")&&j(P.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let me=0;return me=setInterval((()=>{const e=G.songs.map((e=>e.id)),a=G.songs.findIndex((e=>e.id==Q.value[W.value].id));e.length>0&&q(e.join(","),G.songs,"",a)}),3e5),N((()=>{clearInterval(me)})),(s,t)=>{const n=a,i=I("prevent");return r(),c(l(e),{onCellDblclick:pe,onCellMouseEnter:ue,onCellMouseLeave:ve,onSelectionChange:le,data:o.songs,"max-height":o.height,ref_key:"tableContainer",ref:ae,style:{width:"80vw"},class:"songs-table"},{default:d((()=>[l(oe)?(r(),c(n,{key:0,type:"selection",width:l(se)},null,8,["width"])):u("",!0),v(n,{sortable:l(te)[0],"sort-method":ie,label:"歌曲",width:500-l(se)},{default:d((e=>[p("div",null,[p("span",{onMousedown:m((a=>l(ee).addLove(e.row,l(ee).loveSongs,l(ee).loveMusicId,"loveSongs")),["prevent"]),class:g(["iconfont love",{"is-love":e.row.isLove}]),textContent:f(e.row.isLove?"󰅅":"")},null,42,O),p("span",null,f(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(r(),h("span",z,"")):u("",!0),w((r(),h("span",{class:"iconfont playmv",onClick:a=>{return o=e.row,void R(o,(()=>{J()}));var o}},[y("")],8,A)),[[i]]),p("div",D,[w((r(),h("span",{onClick:a=>pe(e.row),class:"iconfont"},[y("")],8,F)),[[b,!l(X)||l(W)!=l(Q).findIndex((a=>a.id==e.row.id))],[i]]),w((r(),h("span",{onClick:t[0]||(t[0]=e=>X.value=!1),class:"iconfont"},[y(" ")])),[[b,l(X)&&l(W)==l(Q).findIndex((a=>a.id==e.row.id))],[i]]),w((r(),h("span",{class:"iconfont",onClick:a=>l(ee).addMuiscDownload(e.row)},[y("󰌄")],8,T)),[[i]]),v(M,{song:e.row,play:pe},null,8,["song"])])])])),_:1},8,["sortable","width"]),v(n,{sortable:l(te)[1],"sort-method":re,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),v(n,{sortable:l(te)[2],"sort-method":ce,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),v(n,{sortable:l(te)[3],"sort-method":de,label:"时长"},{default:d((e=>[p("span",null,f(l(_)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height"])}}});export{E as _};
