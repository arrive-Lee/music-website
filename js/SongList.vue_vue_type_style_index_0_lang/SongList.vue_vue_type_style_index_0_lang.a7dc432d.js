import{y as e,z as a}from"../element-plus/element-plus.372e8740.js";import{G as o,ax as s,i as l,d as t,e as n,M as r,O as i,I as d,u,n as c,o as v,R as p,U as m,a as g,a2 as h,T as w,c as b,P as f,S as y,V as C,z as I,aq as S}from"../@vue/@vue.7ad02ad1.js";import{s as k}from"../pinia/pinia.07d51cb2.js";import{o as M}from"../vue-router/vue-router.47595bf3.js";import{g as x,u as j,a as L,p as _,e as R,d as B,j as H,T as N,U as O,V as P}from"../../assets/index-4c65f7ae.js";const T=["onMousedown","textContent"],q={key:0,class:"iconfont vip"},z=["onClick"],D=["onClick"],F=["onClick"],U=o({__name:"SongList",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(o,{emit:U}){const V=o;s((e=>({c72b991a:u(A),c69e6568:u(G),"146a0235":u(E)})));const A=x().get("fontColor"),E=l((()=>{var e;return"color"==oe.value?null==(e=x().get("background"))?void 0:e.value:"transparent"})),G=x().get("tableHover"),J=I("hideScroll"),K=j(),{songList:Q,current:W,isPlay:X,playProcess:Y,playTime:Z,songListId:$}=k(K),ee=L(),ae=_(),{bgMode:oe}=k(ae),se=t(),le=t("operation-area operation"+Number.parseInt(1e12*Math.random()+"")),te=l((()=>V.showSelect)),ne=l((()=>V.showSelect?55:0)),re=e=>{U("getSelectItems",e)};n(te,(e=>{e||se.value.clearSelection()}));const ie=l((()=>V.sort?V.sort:[!1,!1,!1,!1])),de=l((()=>V.isCancelSort)),ue=(e,a)=>e.name.localeCompare(a.name),ce=(e,a)=>e.singer.localeCompare(a.singer),ve=(e,a)=>e.album.localeCompare(a.album),pe=(e,a)=>+e.time-+a.name;n(de,(e=>{e&&se.value.clearSort()}));const me=()=>document.querySelectorAll("."+le.value.split(" ")[1]),ge=e=>{me()[V.songIdMapper.get(e.id)].style.opacity="1"},he=e=>{me()[V.songIdMapper.get(e.id)].style.opacity="0"},we=async e=>{if("0"==e.available||"8"==e.available){const a=$.value.get(e.id);null==a?(ee.addRecord(e,ee.songRecord,ee.songRecordId,"songRecord"),0==W.value?(X&&(X.value=!1),Y.value=0,Z.value=0,Q.value.unshift(e),await c(),X.value=!0):(Q.value.unshift(e),W.value=0)):W.value!=a?W.value=a:X.value=!0}else(e.available="1")?R(B.INFO,"此歌曲为vip专属"):(e.available="10")&&R(B.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let be=0;return be=setInterval((()=>{const e=V.songs.map((e=>e.id)),a=V.songs.findIndex((e=>e.id==Q.value[W.value].id));e.length>0&&H(e.join(","),V.songs,"",a)}),3e5),M((()=>{clearInterval(be)})),(s,l)=>{const t=a,n=S("prevent");return v(),r(u(e),{onCellDblclick:we,onCellMouseEnter:ge,onCellMouseLeave:he,onSelectionChange:re,data:o.songs,"max-height":o.height,"show-header":o.showHeader,ref_key:"tableContainer",ref:se,style:{width:"80vw"},class:d(["songs-table",{"skin-table":"skin"==u(oe)}])},{default:i((()=>[u(te)?(v(),r(t,{key:0,type:"selection",width:u(ne)},null,8,["width"])):p("",!0),m(t,{sortable:u(ie)[0],"sort-method":ue,label:"歌曲",width:500-u(ne)},{default:i((e=>[g("div",null,[g("span",{onMousedown:h((a=>u(ee).addLove(e.row,u(ee).loveSongs,u(ee).loveMusicId,"loveSongs")),["prevent"]),class:d(["iconfont love",{"is-love":e.row.isLove}]),textContent:w(e.row.isLove?"󰅅":"")},null,42,T),g("span",null,w(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(v(),b("span",q,"")):p("",!0),f((v(),b("span",{class:"iconfont playmv",onClick:a=>{return o=e.row,void P(o,(()=>{J()}));var o}},[y("")],8,z)),[[n]]),g("div",{class:d(le.value)},[f((v(),b("span",{onClick:a=>we(e.row),class:"iconfont"},[y("")],8,D)),[[C,!u(X)||u(W)!=u(Q).findIndex((a=>a.id==e.row.id))],[n]]),f((v(),b("span",{onClick:l[0]||(l[0]=e=>X.value=!1),class:"iconfont"},[y(" ")])),[[C,u(X)&&u(W)==u(Q).findIndex((a=>a.id==e.row.id))],[n]]),f((v(),b("span",{class:"iconfont",onClick:a=>u(ee).addMuiscDownload(e.row)},[y("󰌄")],8,F)),[[n]]),m(N,{song:e.row,play:we},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),m(t,{sortable:u(ie)[1],"sort-method":ce,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),m(t,{sortable:u(ie)[2],"sort-method":ve,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),m(t,{sortable:u(ie)[3],"sort-method":pe,label:"时长"},{default:i((e=>[g("span",null,w(u(O)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header","class"])}}});export{U as _};
