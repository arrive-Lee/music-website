import{y as e,z as a}from"../element-plus/element-plus.372e8740.js";import{G as o,ax as s,u as l,d as t,i as n,e as i,o as r,M as d,O as c,R as u,U as v,a as p,a2 as m,I as g,T as h,c as f,P as w,S as y,V as b,z as C,n as S,aq as I}from"../@vue/@vue.7ad02ad1.js";import{g as k,u as x,a as L,K as M,L as j,e as _,d as P,M as R,j as B}from"../../assets/index-b4bf3e49.js";import{s as q}from"../pinia/pinia.07d51cb2.js";import{o as H}from"../vue-router/vue-router.53ff932e.js";const O=["onMousedown","textContent"],z={key:0,class:"iconfont vip"},A=["onClick"],D={class:"operation"},F=["onClick"],N=["onClick"],T=o({__name:"SongList",props:{songs:null,height:null,isPlaylist:{type:Boolean,default:!1},showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(o,{emit:T}){const E=o;s((e=>({c97fdd84:l(G),c8f2a9d2:l(U),"31621f6c":l(K)})));const G=k().get("fontColor"),K=k().get("background"),U=k().get("tableHover"),V=C("hideScroll"),J=x(),{songList:Q,current:W,isPlay:X,playProcess:Y,playTime:Z,songListId:$}=q(J),ee=L(),ae=t(),oe=n((()=>E.showSelect)),se=n((()=>E.showSelect?55:0)),le=e=>{T("getSelectItems",e)};i(oe,(e=>{e||ae.value.clearSelection()}));const te=n((()=>E.sort?E.sort:[!1,!1,!1,!1])),ne=n((()=>E.isCancelSort));i(ne,(e=>{e&&ae.value.clearSort()}));const ie=(e,a)=>e.name.localeCompare(a.name),re=(e,a)=>e.singer.localeCompare(a.singer),de=(e,a)=>e.album.localeCompare(a.album),ce=(e,a)=>+e.time-+a.name,ue=e=>{const a=E.songs.findIndex((a=>a.id==e.id)),o=document.querySelectorAll(".operation");E.isPlaylist?o[a+1].style.opacity="1":o[a].style.opacity="1"},ve=e=>{const a=E.songs.findIndex((a=>a.id==e.id)),o=document.querySelectorAll(".operation");E.isPlaylist?o[a+1].style.opacity="0":o[a].style.opacity="0"},pe=async e=>{if("0"==e.available||"8"==e.available){const a=$.value.get(e.id);null==a?(ee.addRecord(e,ee.songRecord,ee.songRecordId,"songRecord"),0==W.value?(X&&(X.value=!1),Y.value=0,Z.value=0,Q.value.unshift(e),await S(),X.value=!0):(Q.value.unshift(e),W.value=0)):W.value!=a?W.value=a:X.value=!0}else(e.available="1")?_(P.INFO,"此歌曲为vip专属"):(e.available="10")&&_(P.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let me=0;return me=setInterval((()=>{const e=E.songs.map((e=>e.id)),a=E.songs.findIndex((e=>e.id==Q.value[W.value].id));e.length>0&&B(e.join(","),E.songs,"",a)}),3e5),H((()=>{clearInterval(me)})),(s,t)=>{const n=a,i=I("prevent");return r(),d(l(e),{onCellDblclick:pe,onCellMouseEnter:ue,onCellMouseLeave:ve,onSelectionChange:le,data:o.songs,"max-height":o.height,"show-header":o.showHeader,ref_key:"tableContainer",ref:ae,style:{width:"80vw"},class:"songs-table"},{default:c((()=>[l(oe)?(r(),d(n,{key:0,type:"selection",width:l(se)},null,8,["width"])):u("",!0),v(n,{sortable:l(te)[0],"sort-method":ie,label:"歌曲",width:500-l(se)},{default:c((e=>[p("div",null,[p("span",{onMousedown:m((a=>l(ee).addLove(e.row,l(ee).loveSongs,l(ee).loveMusicId,"loveSongs")),["prevent"]),class:g(["iconfont love",{"is-love":e.row.isLove}]),textContent:h(e.row.isLove?"󰅅":"")},null,42,O),p("span",null,h(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(r(),f("span",z,"")):u("",!0),w((r(),f("span",{class:"iconfont playmv",onClick:a=>{return o=e.row,void R(o,(()=>{V()}));var o}},[y("")],8,A)),[[i]]),p("div",D,[w((r(),f("span",{onClick:a=>pe(e.row),class:"iconfont"},[y("")],8,F)),[[b,!l(X)||l(W)!=l(Q).findIndex((a=>a.id==e.row.id))],[i]]),w((r(),f("span",{onClick:t[0]||(t[0]=e=>X.value=!1),class:"iconfont"},[y(" ")])),[[b,l(X)&&l(W)==l(Q).findIndex((a=>a.id==e.row.id))],[i]]),w((r(),f("span",{class:"iconfont",onClick:a=>l(ee).addMuiscDownload(e.row)},[y("󰌄")],8,N)),[[i]]),v(M,{song:e.row,play:pe},null,8,["song"])])])])),_:1},8,["sortable","width"]),v(n,{sortable:l(te)[1],"sort-method":re,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),v(n,{sortable:l(te)[2],"sort-method":de,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),v(n,{sortable:l(te)[3],"sort-method":ce,label:"时长"},{default:c((e=>[p("span",null,h(l(j)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header"])}}});export{T as _};
