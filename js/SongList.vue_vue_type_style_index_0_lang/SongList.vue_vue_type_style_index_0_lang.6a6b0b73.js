import{y as e,z as a}from"../element-plus/element-plus.ec47f34a.js";import{G as o,ax as s,d as l,i as t,e as n,M as r,O as i,I as d,u,z as c,n as p,o as v,R as m,U as g,a as h,a2 as w,T as f,c as b,P as y,S as C,V as I,aq as k}from"../@vue/@vue.7ad02ad1.js";import{s as S}from"../pinia/pinia.07d51cb2.js";import{o as M}from"../vue-router/vue-router.47595bf3.js";import{t as x,g as j,u as L,a as _,e as R,d as B,j as H,Y as N,Z as O,$ as P}from"../../assets/index-a64598ed.js";const q=["onMousedown","textContent"],z={key:0,class:"iconfont vip"},D=["onClick"],F=["onClick"],G=["onClick"],T=o({__name:"SongList",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(o,{emit:T}){const A=o;s((e=>({"356ee567":u(V),"4d17a3cf":u(Y),"60111adc":u(Z),"755803df":u($)})));const E=x(),{bgMode:U}=S(E),V=j().get("fontColor"),Y=j().get("tableHover"),Z=j().get("background"),$=c("fontGray"),J=c("hideScroll"),K=L(),{songList:Q,current:W,isPlay:X,playProcess:ee,playTime:ae,songListId:oe}=S(K),se=_(),le=l(),te=l("operation-area operation"+Number.parseInt(1e12*Math.random()+"")),ne=t((()=>A.showSelect)),re=t((()=>A.showSelect?55:0)),ie=e=>{T("getSelectItems",e)};n(ne,(e=>{e||le.value.clearSelection()}));const de=t((()=>A.sort?A.sort:[!1,!1,!1,!1])),ue=t((()=>A.isCancelSort)),ce=(e,a)=>e.name.localeCompare(a.name),pe=(e,a)=>e.singer.localeCompare(a.singer),ve=(e,a)=>e.album.localeCompare(a.album),me=(e,a)=>+e.time-+a.name;n(ue,(e=>{e&&le.value.clearSort()}));const ge=()=>document.querySelectorAll("."+te.value.split(" ")[1]),he=e=>{ge()[A.songIdMapper.get(e.id)].style.opacity="1"},we=e=>{ge()[A.songIdMapper.get(e.id)].style.opacity="0"},fe=async e=>{if("0"==e.available||"8"==e.available){const a=oe.value.get(e.id);null==a?(se.addRecord(e,se.songRecord,se.songRecordId),0==W.value?(X&&(X.value=!1),ee.value=0,ae.value=0,Q.value.unshift(e),await p(),X.value=!0):(Q.value.unshift(e),W.value=0)):W.value!=a?W.value=a:X.value=!0}else(e.available="1")?R(B.INFO,"此歌曲为vip专属"):(e.available="10")&&R(B.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let be=0;return be=setInterval((()=>{if(A.songs.length>0){const e=A.songs.map((e=>e.id)),a=A.songs.findIndex((e=>e.id==Q.value[W.value].id));e.length>0&&H(e.join(","),A.songs,"",a)}}),3e5),M((()=>{clearInterval(be)})),(s,l)=>{const t=a,n=k("prevent");return v(),r(u(e),{onCellDblclick:fe,onCellMouseEnter:he,onCellMouseLeave:we,onSelectionChange:ie,data:o.songs,"max-height":o.height,"show-header":o.showHeader,ref_key:"tableContainer",ref:le,style:{width:"80vw"},class:d(["songs-table",{"skin-table":"skin"==u(U)}])},{default:i((()=>[u(ne)?(v(),r(t,{key:0,type:"selection",width:u(re)},null,8,["width"])):m("",!0),g(t,{sortable:u(de)[0],"sort-method":ce,label:"歌曲",width:500-u(re)},{default:i((e=>[h("div",null,[h("span",{onMousedown:w((a=>u(se).addLove(e.row,u(se).loveSongs,u(se).loveMusicId)),["prevent"]),class:d(["iconfont love",{"is-love":e.row.isLove}]),textContent:f(e.row.isLove?"󰅅":"")},null,42,q),h("span",null,f(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(v(),b("span",z,"")):m("",!0),y((v(),b("span",{class:"iconfont playmv",onClick:a=>{return o=e.row,void P(o,(()=>{J()}));var o}},[C("")],8,D)),[[n]]),h("div",{class:d(te.value)},[y((v(),b("span",{onClick:a=>fe(e.row),class:"iconfont"},[C("")],8,F)),[[I,!u(X)||u(W)!=u(Q).findIndex((a=>a.id==e.row.id))],[n]]),y((v(),b("span",{onClick:l[0]||(l[0]=e=>X.value=!1),class:"iconfont"},[C(" ")])),[[I,u(X)&&u(W)==u(Q).findIndex((a=>a.id==e.row.id))],[n]]),y((v(),b("span",{class:"iconfont",onClick:a=>u(se).addMuiscDownload(e.row)},[C("󰌄")],8,G)),[[n]]),g(N,{song:e.row,play:fe},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),g(t,{sortable:u(de)[1],"sort-method":pe,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),g(t,{sortable:u(de)[2],"sort-method":ve,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),g(t,{sortable:u(de)[3],"sort-method":me,label:"时长"},{default:i((e=>[h("span",null,f(u(O)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header","class"])}}});export{T as _};
