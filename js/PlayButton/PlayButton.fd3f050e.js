import{x as e,y as a,z as s}from"../element-plus/element-plus.1ffadbb7.js";import{G as o,ax as l,r as t,i as n,e as r,M as i,O as d,I as u,u as c,z as p,n as v,o as g,R as m,U as h,a as b,a2 as f,T as w,c as C,P as y,S as I,V as S,aq as k,ay as M,az as _}from"../@vue/@vue.59fec093.js";import{s as x}from"../pinia/pinia.81428a33.js";import{o as L}from"../vue-router/vue-router.2f940de9.js";import{t as j,g as N,u as P,a as B,e as O,d as R,j as z,a0 as E,A as F,a1 as H,_ as q}from"../../assets/index-933c3f88.js";const A=["onMousedown","textContent"],D={key:0,class:"iconfont vip"},G=["onClick"],T=["onClick"],U=["onClick"],V=o({__name:"SongList",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(s,{emit:o}){const M=s;l((e=>({"1444f4f6":c(V),"3dc9d2de":c(J),"68af35e3":c(K),f66b7320:c(Q),"3e3aaa90":c(W)})));const _=j(),{bgMode:q}=x(_),V=N().get("fontColor"),J=N().get("tableHover"),K=N().get("background"),Q=p("fontGray"),W=N().get("themeColor"),X=p("hideScroll"),Y=P(),{songList:Z,current:$,isPlay:ee,playProcess:ae,playTime:se,songListId:oe}=x(Y),le=B(),te=t(),ne=t("operation-area operation"+Number.parseInt(1e12*Math.random()+"")),re=n((()=>M.showSelect)),ie=n((()=>M.showSelect?55:0)),de=e=>{o("getSelectItems",e)};r(re,(e=>{e||te.value.clearSelection()}));const ue=n((()=>M.sort?M.sort:[!1,!1,!1,!1])),ce=n((()=>M.isCancelSort)),pe=(e,a)=>e.name.localeCompare(a.name),ve=(e,a)=>e.singer.localeCompare(a.singer),ge=(e,a)=>e.album.localeCompare(a.album),me=(e,a)=>+e.time-+a.name;r(ce,(e=>{e&&te.value.clearSort()}));const he=()=>document.querySelectorAll("."+ne.value.split(" ")[1]),be=e=>{he()[M.songIdMapper.get(e.id)].style.opacity="1"},fe=e=>{he()[M.songIdMapper.get(e.id)]&&(he()[M.songIdMapper.get(e.id)].style.opacity="0")},we=async e=>{if("0"==e.available||"8"==e.available){const a=oe.value.get(e.id);null==a?(le.addRecord(e,le.songRecord,le.songRecordId),0==$.value?(ee&&(ee.value=!1),ae.value=0,se.value=0,Z.value.unshift(e),await v(),ee.value=!0):(Z.value.unshift(e),$.value=0)):$.value!=a?$.value=a:ee.value=!0}else"1"==e.available?O(R.INFO,"此歌曲为vip专属"):"10"==e.available&&O(R.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let Ce=0;return Ce=setInterval((()=>{if(M.songs.length>0){const e=M.songs.map((e=>e.id)),a=M.songs.findIndex((e=>e.id==Z.value[$.value].id));e.length>0&&z(e.join(","),M.songs,"",a)}}),3e5),L((()=>{clearInterval(Ce)})),(o,l)=>{const t=a,n=k("prevent");return g(),i(c(e),{onCellDblclick:we,onCellMouseEnter:be,onCellMouseLeave:fe,onSelectionChange:de,data:s.songs,"max-height":s.height,"show-header":s.showHeader,ref_key:"tableContainer",ref:te,style:{width:"80vw"},class:u(["songs-table",{"skin-table":"skin"==c(q)}])},{default:d((()=>[c(re)?(g(),i(t,{key:0,type:"selection",width:c(ie)},null,8,["width"])):m("",!0),h(t,{sortable:c(ue)[0],"sort-method":pe,label:"歌曲",width:500-c(ie)},{default:d((e=>[b("div",null,[b("span",{onMousedown:f((a=>c(le).addLove(e.row,c(le).loveSongs,c(le).loveMusicId)),["prevent"]),class:u(["iconfont love",{"is-love":e.row.isLove}]),textContent:w(e.row.isLove?"󰅅":"")},null,42,A),b("span",null,w(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(g(),C("span",D,"")):m("",!0),y((g(),C("span",{class:"iconfont playmv",onClick:a=>{return s=e.row,void H(s,(()=>{X()}));var s}},[I("")],8,G)),[[n]]),b("div",{class:u(ne.value)},[y((g(),C("span",{onClick:a=>we(e.row),class:"iconfont"},[I("")],8,T)),[[S,!c(ee)||c($)!=c(Z).findIndex((a=>a.id==e.row.id))],[n]]),y((g(),C("span",{onClick:l[0]||(l[0]=e=>ee.value=!1),class:"iconfont"},[I(" ")])),[[S,c(ee)&&c($)==c(Z).findIndex((a=>a.id==e.row.id))],[n]]),y((g(),C("span",{class:"iconfont",onClick:a=>c(le).addMuiscDownload(e.row)},[I("󰌄")],8,U)),[[n]]),h(E,{song:e.row,play:we},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),h(t,{sortable:c(ue)[1],"sort-method":ve,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),h(t,{sortable:c(ue)[2],"sort-method":ge,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),h(t,{sortable:c(ue)[3],"sort-method":me,label:"时长"},{default:d((e=>[b("span",null,w(c(F)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header","class"])}}}),J=(e=>(M("data-v-cbb4b56a"),e=e(),_(),e))((()=>b("span",{class:"iconfont"},"",-1))),K=q(o({__name:"PlayButton",props:{songs:null,name:{default:"播放全部"}},setup(e){const a=e;l((e=>({"0425d13f":c(t),"3beef406":c(o)})));const o=N().get("shadow"),t=N().get("themeColor"),n=P(),{songList:r,current:u,songNum:p,songListId:v}=x(n),m=()=>{if(a.songs.length>0){const e=p.value;a.songs.forEach((e=>{null!=v.value.get(e.id)||"0"!=e.available&&"8"!=e.available||r.value.push(e)})),u.value=e,O(R.SUCCESS,"已经添加到播放列表")}else O(R.INFO,"请添加歌曲")};return(a,o)=>{const l=s;return g(),i(l,{onClick:m},{default:d((()=>[J,I(w(e.name),1)])),_:1})}}}),[["__scopeId","data-v-cbb4b56a"]]);export{K as P,V as _};
