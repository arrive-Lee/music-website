import{y as e,z as a,A as s}from"../element-plus/element-plus.4a0090f9.js";import{G as o,ax as l,r as t,i as n,e as i,h as r,M as u,O as d,I as c,u as v,z as p,n as g,o as m,R as h,U as b,a as f,a2 as w,T as C,c as y,P as I,S,V as k,aq as _,ay as x,az as L}from"../@vue/@vue.59fec093.js";import{s as M}from"../pinia/pinia.81428a33.js";import{o as j}from"../vue-router/vue-router.2f940de9.js";import{t as P,g as B,u as N,a as O,e as R,d as z,j as E,a1 as F,A as H,a2 as A,_ as D}from"../../assets/index-80c2d692.js";const G=["onMousedown","textContent"],T={key:0,class:"iconfont vip"},U=["onClick"],q=["onClick"],V=["onClick"],J=o({__name:"SongList",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(s,{emit:o}){const x=s;l((e=>({"5d090782":v(J),"43f166a7":v(K),"170f428c":v(Q),"871d9bf2":v(W),"6b05e6e2":v(X)})));const L=P(),{bgMode:D}=M(L),J=B().get("fontColor"),K=B().get("tableHover"),Q=B().get("background"),W=p("fontGray"),X=B().get("themeColor"),Y=p("hideScroll"),Z=N(),{songList:$,current:ee,isPlay:ae,playProcess:se,playTime:oe,songListId:le}=M(Z),te=O(),ne=t(),ie=n((()=>x.showSelect)),re=n((()=>x.showSelect?55:0)),ue=e=>{o("getSelectItems",e)};i(ie,(e=>{e||ne.value.clearSelection()}));const de=n((()=>x.sort?x.sort:[!1,!1,!1,!1])),ce=n((()=>x.isCancelSort)),ve=(e,a)=>e.name.localeCompare(a.name),pe=(e,a)=>e.singer.localeCompare(a.singer),ge=(e,a)=>e.album.localeCompare(a.album),me=(e,a)=>+e.time-+a.time;i(ce,(e=>{e&&ne.value.clearSort()}));const he=t(""),be=e=>{he.value=e.id},fe=async e=>{if("0"==e.available||"8"==e.available){const a=le.value.get(e.id);null==a?(te.addRecord(e,te.songRecord,te.songRecordId),0==ee.value?(ae&&(ae.value=!1),se.value=0,oe.value=0,$.value.unshift(e),await g(),ae.value=!0):($.value.unshift(e),ee.value=0)):ee.value!=a?ee.value=a:ae.value=!0}else"1"==e.available?R(z.INFO,"此歌曲为vip专属"):"10"==e.available&&R(z.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};r((()=>{}));let we=0;return we=setInterval((()=>{if(x.songs.length>0){const e=x.songs.map((e=>e.id)),a=x.songs.findIndex((e=>e.id==$.value[ee.value].id));e.length>0&&E(e.join(","),x.songs,"",a)}}),3e5),j((()=>{clearInterval(we)})),(o,l)=>{const t=a,n=_("prevent");return m(),u(v(e),{onCellDblclick:fe,onCellMouseEnter:be,onCellMouseLeave:l[1]||(l[1]=e=>he.value=""),onSelectionChange:ue,data:s.songs,"max-height":s.height,"show-header":s.showHeader,ref_key:"tableContainer",ref:ne,style:{width:"80vw"},class:c(["songs-table",{"skin-table":"skin"==v(D)}])},{default:d((()=>[v(ie)?(m(),u(t,{key:0,type:"selection",width:v(re)},null,8,["width"])):h("",!0),b(t,{sortable:v(de)[0],"sort-method":ve,label:"歌曲",width:500-v(re)},{default:d((e=>[f("div",null,[f("span",{onMousedown:w((a=>v(te).addLove(e.row,v(te).loveSongs,v(te).loveMusicId)),["prevent"]),class:c(["iconfont love",{"is-love":e.row.isLove}]),textContent:C(e.row.isLove?"󰅅":"")},null,42,G),f("span",null,C(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(m(),y("span",T,"")):h("",!0),I((m(),y("span",{class:"iconfont playmv",onClick:a=>{return s=e.row,void A(s,(()=>{Y()}));var s}},[S("")],8,U)),[[n]]),f("div",{class:c(["operation-area",{"is-active":he.value==e.row.id}])},[I((m(),y("span",{onClick:a=>fe(e.row),class:"iconfont"},[S("")],8,q)),[[k,!v(ae)||v(ee)!=v($).findIndex((a=>a.id==e.row.id))],[n]]),I((m(),y("span",{onClick:l[0]||(l[0]=e=>ae.value=!1),class:"iconfont"},[S(" ")])),[[k,v(ae)&&v(ee)==v($).findIndex((a=>a.id==e.row.id))],[n]]),I((m(),y("span",{class:"iconfont",onClick:a=>v(te).addMuiscDownload(e.row)},[S("󰌄")],8,V)),[[n]]),b(F,{song:e.row,play:fe},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),b(t,{sortable:v(de)[1],"sort-method":pe,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),b(t,{sortable:v(de)[2],"sort-method":ge,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),b(t,{sortable:v(de)[3],"sort-method":me,label:"时长"},{default:d((e=>[f("span",null,C(v(H)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header","class"])}}}),K=(e=>(x("data-v-cbb4b56a"),e=e(),L(),e))((()=>f("span",{class:"iconfont"},"",-1))),Q=D(o({__name:"PlayButton",props:{songs:null,name:{default:"播放全部"}},setup(e){const a=e;l((e=>({"0425d13f":v(t),"3beef406":v(o)})));const o=B().get("shadow"),t=B().get("themeColor"),n=N(),{songList:i,current:r,songNum:c,songListId:p}=M(n),g=()=>{if(a.songs.length>0){const e=c.value;a.songs.forEach((e=>{null!=p.value.get(e.id)||"0"!=e.available&&"8"!=e.available||i.value.push(e)})),r.value=e,R(z.SUCCESS,"已经添加到播放列表")}else R(z.INFO,"请添加歌曲")};return(a,o)=>{const l=s;return m(),u(l,{onClick:g},{default:d((()=>[K,S(C(e.name),1)])),_:1})}}}),[["__scopeId","data-v-cbb4b56a"]]);export{Q as P,J as _};
