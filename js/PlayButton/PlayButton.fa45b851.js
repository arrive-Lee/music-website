import{x as e,y as a,z as s}from"../element-plus/element-plus.f7914039.js";import{G as o,ax as l,d as t,i as n,e as r,M as i,O as d,I as u,u as c,z as p,n as v,o as g,R as m,U as f,a as h,a2 as b,T as w,c as y,P as C,S as I,V as S,aq as k,ay as _,az as M}from"../@vue/@vue.7ad02ad1.js";import{s as x}from"../pinia/pinia.07d51cb2.js";import{o as L}from"../vue-router/vue-router.47595bf3.js";import{t as j,g as N,u as P,a as B,e as O,d as R,j as z,Y as E,Z as F,$ as H,_ as q}from"../../assets/index-be634f60.js";const D=["onMousedown","textContent"],G={key:0,class:"iconfont vip"},T=["onClick"],U=["onClick"],A=["onClick"],V=o({__name:"SongList",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(s,{emit:o}){const _=s;l((e=>({"356ee567":c(V),"4d17a3cf":c(Y),"60111adc":c(Z),"755803df":c($)})));const M=j(),{bgMode:q}=x(M),V=N().get("fontColor"),Y=N().get("tableHover"),Z=N().get("background"),$=p("fontGray"),J=p("hideScroll"),K=P(),{songList:Q,current:W,isPlay:X,playProcess:ee,playTime:ae,songListId:se}=x(K),oe=B(),le=t(),te=t("operation-area operation"+Number.parseInt(1e12*Math.random()+"")),ne=n((()=>_.showSelect)),re=n((()=>_.showSelect?55:0)),ie=e=>{o("getSelectItems",e)};r(ne,(e=>{e||le.value.clearSelection()}));const de=n((()=>_.sort?_.sort:[!1,!1,!1,!1])),ue=n((()=>_.isCancelSort)),ce=(e,a)=>e.name.localeCompare(a.name),pe=(e,a)=>e.singer.localeCompare(a.singer),ve=(e,a)=>e.album.localeCompare(a.album),ge=(e,a)=>+e.time-+a.name;r(ue,(e=>{e&&le.value.clearSort()}));const me=()=>document.querySelectorAll("."+te.value.split(" ")[1]),fe=e=>{me()[_.songIdMapper.get(e.id)].style.opacity="1"},he=e=>{me()[_.songIdMapper.get(e.id)].style.opacity="0"},be=async e=>{if("0"==e.available||"8"==e.available){const a=se.value.get(e.id);null==a?(oe.addRecord(e,oe.songRecord,oe.songRecordId),0==W.value?(X&&(X.value=!1),ee.value=0,ae.value=0,Q.value.unshift(e),await v(),X.value=!0):(Q.value.unshift(e),W.value=0)):W.value!=a?W.value=a:X.value=!0}else(e.available="1")?O(R.INFO,"此歌曲为vip专属"):(e.available="10")&&O(R.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let we=0;return we=setInterval((()=>{if(_.songs.length>0){const e=_.songs.map((e=>e.id)),a=_.songs.findIndex((e=>e.id==Q.value[W.value].id));e.length>0&&z(e.join(","),_.songs,"",a)}}),3e5),L((()=>{clearInterval(we)})),(o,l)=>{const t=a,n=k("prevent");return g(),i(c(e),{onCellDblclick:be,onCellMouseEnter:fe,onCellMouseLeave:he,onSelectionChange:ie,data:s.songs,"max-height":s.height,"show-header":s.showHeader,ref_key:"tableContainer",ref:le,style:{width:"80vw"},class:u(["songs-table",{"skin-table":"skin"==c(q)}])},{default:d((()=>[c(ne)?(g(),i(t,{key:0,type:"selection",width:c(re)},null,8,["width"])):m("",!0),f(t,{sortable:c(de)[0],"sort-method":ce,label:"歌曲",width:500-c(re)},{default:d((e=>[h("div",null,[h("span",{onMousedown:b((a=>c(oe).addLove(e.row,c(oe).loveSongs,c(oe).loveMusicId)),["prevent"]),class:u(["iconfont love",{"is-love":e.row.isLove}]),textContent:w(e.row.isLove?"󰅅":"")},null,42,D),h("span",null,w(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(g(),y("span",G,"")):m("",!0),C((g(),y("span",{class:"iconfont playmv",onClick:a=>{return s=e.row,void H(s,(()=>{J()}));var s}},[I("")],8,T)),[[n]]),h("div",{class:u(te.value)},[C((g(),y("span",{onClick:a=>be(e.row),class:"iconfont"},[I("")],8,U)),[[S,!c(X)||c(W)!=c(Q).findIndex((a=>a.id==e.row.id))],[n]]),C((g(),y("span",{onClick:l[0]||(l[0]=e=>X.value=!1),class:"iconfont"},[I(" ")])),[[S,c(X)&&c(W)==c(Q).findIndex((a=>a.id==e.row.id))],[n]]),C((g(),y("span",{class:"iconfont",onClick:a=>c(oe).addMuiscDownload(e.row)},[I("󰌄")],8,A)),[[n]]),f(E,{song:e.row,play:be},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),f(t,{sortable:c(de)[1],"sort-method":pe,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),f(t,{sortable:c(de)[2],"sort-method":ve,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),f(t,{sortable:c(de)[3],"sort-method":ge,label:"时长"},{default:d((e=>[h("span",null,w(c(F)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header","class"])}}}),Y=(e=>(_("data-v-dbff7fc1"),e=e(),M(),e))((()=>h("span",{class:"iconfont"},"",-1))),Z=q(o({__name:"PlayButton",props:{songs:null,name:{default:"播放全部"}},setup(e){const a=e;l((e=>({"4e76bc8c":c(o)})));const o=N().get("shadow"),t=P(),{songList:n,current:r,songNum:u,songListId:p}=x(t),v=()=>{if(a.songs.length>0){const e=u.value;a.songs.forEach((e=>{null!=p.value.get(e.id)||"0"!=e.available&&"8"!=e.available||n.value.push(e)})),r.value=e,O(R.SUCCESS,"已经添加到播放列表")}else O(R.INFO,"请添加歌曲")};return(a,o)=>{const l=s;return g(),i(l,{onClick:v},{default:d((()=>[Y,I(w(e.name),1)])),_:1})}}}),[["__scopeId","data-v-dbff7fc1"]]);export{Z as P,V as _};
