import{y as e,z as a,A as s}from"../element-plus/element-plus.4a0090f9.js";import{G as o,ax as l,r as t,i as n,e as i,M as r,O as u,u as d,I as c,z as v,n as p,o as g,R as m,U as h,a as b,a2 as f,T as w,c as C,P as y,S as I,V as S,aq as k,ay as _,az as x}from"../@vue/@vue.59fec093.js";import{s as L}from"../pinia/pinia.81428a33.js";import{o as M}from"../vue-router/vue-router.2f940de9.js";import{t as j,g as P,u as B,a as N,e as O,d as R,j as z,a1 as E,A as F,a2 as H,_ as A}from"../../assets/index-f978d246.js";import{t as D}from"../lodash-es/lodash-es.3125e237.js";const G=["onMousedown","textContent"],T={key:0,class:"iconfont vip"},U=["onClick"],q=["onClick"],V=["onClick"],J=o({__name:"SongList",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0}},emits:["getSelectItems"],setup(s,{emit:o}){const _=s;l((e=>({"63b08c60":d(J),"053514b8":d(K),"013cd249":d(Q),"1f6e7e56":d(W),"6358811e":d(X)})));const x=j(),{bgMode:A}=L(x),J=P().get("fontColor"),K=P().get("tableHover"),Q=P().get("background"),W=v("fontGray"),X=P().get("themeColor"),Y=v("hideScroll"),Z=B(),{songList:$,current:ee,isPlay:ae,playProcess:se,playTime:oe,songListId:le}=L(Z),te=N(),ne=t(),ie=n((()=>_.showSelect)),re=n((()=>_.showSelect?55:0)),ue=e=>{o("getSelectItems",e)};i(ie,(e=>{e||ne.value.clearSelection()}));const de=n((()=>_.sort?_.sort:[!1,!1,!1,!1])),ce=n((()=>_.isCancelSort)),ve=(e,a)=>e.name.localeCompare(a.name),pe=(e,a)=>e.singer.localeCompare(a.singer),ge=(e,a)=>e.album.localeCompare(a.album),me=(e,a)=>+e.time-+a.time;i(ce,(e=>{e&&ne.value.clearSort()}));const he=t(""),be=D((()=>{he.value=""}),50,{leading:!0,trailing:!1}),fe=e=>{he.value=e.id},we=async e=>{if("0"==e.available||"8"==e.available){const a=le.value.get(e.id);null==a?(te.addRecord(e,te.songRecord,te.songRecordId),0==ee.value?(ae&&(ae.value=!1),se.value=0,oe.value=0,$.value.unshift(e),await p(),ae.value=!0):($.value.unshift(e),ee.value=0)):ee.value!=a?ee.value=a:ae.value=!0}else"1"==e.available?O(R.INFO,"此歌曲为vip专属"):"10"==e.available&&O(R.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let Ce=0;return Ce=setInterval((()=>{if(_.songs.length>0){const e=_.songs.map((e=>e.id)),a=_.songs.findIndex((e=>e.id==$.value[ee.value].id));e.length>0&&z(e.join(","),_.songs,"",a)}}),3e5),M((()=>{clearInterval(Ce)})),(o,l)=>{const t=a,n=k("prevent");return g(),r(d(e),{onCellDblclick:we,onCellMouseEnter:fe,onCellMouseLeave:d(be),onSelectionChange:ue,data:s.songs,"max-height":s.height,"show-header":s.showHeader,ref_key:"tableContainer",ref:ne,style:{width:"80vw"},class:c(["songs-table",{"skin-table":"skin"==d(A)}])},{default:u((()=>[d(ie)?(g(),r(t,{key:0,type:"selection",width:d(re)},null,8,["width"])):m("",!0),h(t,{sortable:d(de)[0],"sort-method":ve,label:"歌曲",width:500-d(re)},{default:u((e=>[b("div",null,[b("span",{onMousedown:f((a=>d(te).addLove(e.row,d(te).loveSongs,d(te).loveMusicId)),["prevent"]),class:c(["iconfont love",{"is-love":e.row.isLove}]),textContent:w(e.row.isLove?"󰅅":"")},null,42,G),b("span",null,w(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(g(),C("span",T,"")):m("",!0),y((g(),C("span",{class:"iconfont playmv",onClick:a=>{return s=e.row,void H(s,(()=>{Y()}));var s}},[I("")],8,U)),[[n]]),b("div",{class:c(["operation-area",{"is-active":he.value==e.row.id}])},[y((g(),C("span",{onClick:a=>we(e.row),class:"iconfont"},[I("")],8,q)),[[S,!d(ae)||d(ee)!=d($).findIndex((a=>a.id==e.row.id))],[n]]),y((g(),C("span",{onClick:l[0]||(l[0]=e=>ae.value=!1),class:"iconfont"},[I(" ")])),[[S,d(ae)&&d(ee)==d($).findIndex((a=>a.id==e.row.id))],[n]]),y((g(),C("span",{class:"iconfont",onClick:a=>d(te).addMuiscDownload(e.row)},[I("󰌄")],8,V)),[[n]]),h(E,{song:e.row,play:we},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),h(t,{sortable:d(de)[1],"sort-method":pe,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),h(t,{sortable:d(de)[2],"sort-method":ge,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),h(t,{sortable:d(de)[3],"sort-method":me,label:"时长"},{default:u((e=>[b("span",null,w(d(F)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["onCellMouseLeave","data","max-height","show-header","class"])}}}),K=(e=>(_("data-v-cbb4b56a"),e=e(),x(),e))((()=>b("span",{class:"iconfont"},"",-1))),Q=A(o({__name:"PlayButton",props:{songs:null,name:{default:"播放全部"}},setup(e){const a=e;l((e=>({"0425d13f":d(t),"3beef406":d(o)})));const o=P().get("shadow"),t=P().get("themeColor"),n=B(),{songList:i,current:c,songNum:v,songListId:p}=L(n),m=()=>{if(a.songs.length>0){const e=v.value;a.songs.forEach((e=>{null!=p.value.get(e.id)||"0"!=e.available&&"8"!=e.available||i.value.push(e)})),c.value=e,O(R.SUCCESS,"已经添加到播放列表")}else O(R.INFO,"请添加歌曲")};return(a,o)=>{const l=s;return g(),r(l,{onClick:m},{default:u((()=>[K,I(w(e.name),1)])),_:1})}}}),[["__scopeId","data-v-cbb4b56a"]]);export{Q as P,J as _};
